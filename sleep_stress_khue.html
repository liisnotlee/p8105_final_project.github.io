<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>sleep_stress_EDA</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-solid fa-spa"></span>
     
  </a>
</li>
<li class="dropdown-header">Data</li>
<li class="dropdown-header">Report</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lifestyle Factors Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="hormone.html">Hormone</a>
    </li>
    <li class="dropdown-header">Exercise</li>
    <li class="dropdown-header">Sleep &amp; Stress</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown-header">Meet the Team</li>
<li>
  <a>
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">sleep_stress_EDA</h1>

</div>


<p>Load the data</p>
<p>View the sleep time for different participants in each study
interval</p>
<pre class="r"><code># plot the mean timein bed in hour
sleep |&gt;
  group_by(id, study_interval)|&gt;
  summarize(mean_sleep = mean(timeinbed/60),
            sd_sleep = sd(timeinbed),
            mean_efficiency = mean(efficiency),
            sd_efficiency = sd(efficiency)) |&gt;
  ggplot(aes(x = id, y = mean_sleep, color = id))+
  geom_point()+
  facet_grid(study_interval~.)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;id&#39;. You can override using the `.groups`
## argument.</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>The average sleep time for each person is different each study
interval and varied across participants. In 2022, some participants
slept less than 5 hours and some slept more than 8 hours. In 2024, most
participants have better sleep length, 7-8 hours.</p>
<p>Combine the sleep and stress score</p>
<pre class="r"><code># join two data sets, using inner join
sleep_score1 = sleep_score |&gt;
  select(id,study_interval, day_in_study, overall_score, deep_sleep_in_minutes)

sleep1 = sleep|&gt;
   select(id,study_interval, sleep_start_day_in_study, timeinbed) |&gt;
   mutate(day_in_study = sleep_start_day_in_study) |&gt;
  select(-sleep_start_day_in_study)
stress_score1 = stress_score |&gt;
  filter(calculation_failed == &quot;FALSE&quot;)|&gt;
  select(id, study_interval, day_in_study, stress_score)|&gt;
  distinct(id, study_interval, day_in_study, .keep_all = TRUE)

sleep_stress = inner_join(sleep_score1, stress_score1, join_by(&quot;id&quot;, &quot;study_interval&quot;, &quot;day_in_study&quot;))
 
# check of na values
sum(is.na(sleep_stress$overall_score))</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>sum(is.na(sleep_stress$stress_score))</code></pre>
<pre><code>## [1] 0</code></pre>
<p>Showing the sleep score and stress score changes</p>
<pre class="r"><code># graphs to show the score across ids
sleep_stress|&gt;
  group_by(id) |&gt; 
  summarize(
    mean_sleep_score = mean(overall_score, na.rm = TRUE),
    mean_stress_score = mean(stress_score, na.rm = TRUE),
    .groups = &quot;drop&quot;
  ) |&gt;
  ggplot(aes(x = id, mean_sleep_score)) +
  geom_smooth(aes(y = mean_sleep_score, color = &quot;mean_sleep_score&quot;), se= FALSE )+
  geom_smooth(aes(y = mean_stress_score, color = &quot;mean_stress_score&quot;), se = FALSE) </code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;
## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Load and clean the hormone data for menstrual phases</p>
<pre class="r"><code>hormone1 = hormone |&gt;
  select(id,phase, day_in_study, lh, estrogen,fatigue,moodswing)|&gt;
  mutate(
    phase = factor(phase, levels = c(&quot;Follicular&quot;, &quot;Fertility&quot;, &quot;Luteal&quot;, &quot;Menstrual&quot;)),
    fatigue = factor(fatigue, 
                     levels = c(&quot;Low&quot;, &quot;Moderate&quot;, &quot;High&quot;, &quot;Very High&quot;)),
    moodswing = factor(moodswing,
                       levels = c(&quot;Very Low/Little&quot;, &quot;Low&quot;, &quot;Moderate&quot;, &quot;High&quot;,&quot;Very High&quot;,&quot;Not at all&quot;))
  )
phase_order &lt;- c(&quot;Menstrual&quot;, &quot;Follicular&quot;, &quot;Fertility&quot;, &quot;Luteal&quot;)</code></pre>
<p>Joined data with the phase in hormone dataset</p>
<pre class="r"><code>sleep_stress_hormone =
  inner_join(sleep_stress,hormone1, join_by(id, day_in_study))</code></pre>
<p>Now explore the changes of the stress score with the menstrual cycle.
The participants slept best during the menstrual time, probably a good
sign to rest well during this time. The lowest sleep score were recorded
during ovulation/ fertility time in which the increased estrogen and lh
levels may contribute to this low sleep quality. The higher stress score
the less stressful people experience. In this study, the participants
showed the least stressful during folicular period , as the bodies are
full of energy. The most stressful time is during luteal period.</p>
<pre class="r"><code>plot_1 = 
  sleep_stress_hormone |&gt;
  group_by(phase) |&gt;
  summarize(
    mean_sleep_score = mean(overall_score, na.rm = TRUE),
    mean_stress_score = mean(stress_score, na.rm = TRUE),
    .groups = &quot;drop&quot;
  ) |&gt;
  pivot_longer(
    cols = starts_with(&quot;mean_&quot;),
    names_to = &quot;metric&quot;,
    values_to = &quot;value&quot;
  ) |&gt;
  mutate(
    metric = recode(metric,
                    mean_sleep_score  = &quot;Sleep Score&quot;,
                    mean_stress_score = &quot;Stress Score&quot;),
    phase = factor(phase, levels = phase_order)
  ) |&gt;
  ggplot(aes(x = phase, y = value, color = metric, group = metric)) +
    geom_smooth(linewidth= 1) +
    geom_point(size = 3) +
    labs(color = &quot;Metric&quot;, y = &quot;Mean Score&quot;, x = &quot;Phase&quot;) +
    labs(
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Score&quot;
  ) +
    theme_minimal() +
  theme(legend.position = &quot;bottom&quot;,
    axis.text.x = element_text(angle = 45, hjust = 1))

plot_2  =
  sleep_stress_hormone |&gt;
  group_by(phase) |&gt;
  summarize(
    mean_lh = mean(lh, na.rm = TRUE),
    mean_estrogen = mean( estrogen, na.rm = TRUE),
    .groups = &quot;drop&quot;
  ) |&gt;
  pivot_longer(
    cols = starts_with(&quot;mean_&quot;),
    names_to = &quot;metric&quot;,
    values_to = &quot;value&quot;
  ) |&gt;
  mutate(
    metric = recode(metric,
                    mean_lh           = &quot;LH&quot;,
                    mean_estrogen     = &quot;Estrogen&quot;),
    phase = factor(phase, levels = phase_order)
  ) |&gt;
  ggplot(aes(x = phase, y = value, color = metric, group = metric)) +
    geom_smooth(linewidth= 1) +
    geom_point(size = 3) +
    labs(color = &quot;Metric&quot;, y = &quot;level&quot;, x = &quot;Phase&quot;) +
    labs(
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Level&quot;
  ) +
    theme_minimal() +
  theme(legend.position = &quot;bottom&quot;,
    axis.text.x = element_text(angle = 45, hjust = 1))

plot_1+ plot_2</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : span too small.  fewer data values than degrees of freedom.</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : pseudoinverse used at 0.985</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : neighborhood radius 2.015</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : reciprocal condition number 0</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : There are other near singularities as well. 4.0602</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : span too small.  fewer
## data values than degrees of freedom.</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 0.985</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 2.015</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 0</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 4.0602</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : span too small.  fewer data values than degrees of freedom.</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : pseudoinverse used at 0.985</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : neighborhood radius 2.015</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : reciprocal condition number 0</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : There are other near singularities as well. 4.0602</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : span too small.  fewer
## data values than degrees of freedom.</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 0.985</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 2.015</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 0</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 4.0602</code></pre>
<pre><code>## Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
## -Inf
## Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
## -Inf</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : span too small.  fewer data values than degrees of freedom.</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : pseudoinverse used at 0.985</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : neighborhood radius 2.015</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : reciprocal condition number 0</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : There are other near singularities as well. 4.0602</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : span too small.  fewer
## data values than degrees of freedom.</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 0.985</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 2.015</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 0</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 4.0602</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : span too small.  fewer data values than degrees of freedom.</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : pseudoinverse used at 0.985</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : neighborhood radius 2.015</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : reciprocal condition number 0</code></pre>
<pre><code>## Warning in simpleLoess(y, x, w, span, degree = degree, parametric = parametric,
## : There are other near singularities as well. 4.0602</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : span too small.  fewer
## data values than degrees of freedom.</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : pseudoinverse used at
## 0.985</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : neighborhood radius
## 2.015</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : reciprocal condition
## number 0</code></pre>
<pre><code>## Warning in predLoess(object$y, object$x, newx = if (is.null(newdata)) object$x
## else if (is.data.frame(newdata))
## as.matrix(model.frame(delete.response(terms(object)), : There are other near
## singularities as well. 4.0602</code></pre>
<pre><code>## Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
## -Inf
## Warning in max(ids, na.rm = TRUE): no non-missing arguments to max; returning
## -Inf</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Variation of sleep score across menstrual cycle phases</p>
<pre class="r"><code>sleep_stress_hormone |&gt;
  ggplot(aes(x = phase, y = overall_score, fill = phase))+
  geom_violin(alpha = 0.5)+
  geom_boxplot(width = 0.2)+
      labs(
    title = &quot;Sleep Score Across Menstrual Cycle Phases&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;score&quot;
  ) +
    theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Variation of stress score across menstrual cycle phases</p>
<pre class="r"><code>sleep_stress_hormone |&gt;
  ggplot(aes(x = phase, y = stress_score, fill = phase))+
  geom_violin(alpha = 0.5)+
  geom_boxplot(width = 0.2)+
      labs(
    title = &quot;Stress Score Across Menstrual Cycle Phases&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;score&quot;
  ) +
    theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Explore the variation among different participants. adding the id,
ethnicity and birthyear of the subjects.</p>
<pre class="r"><code>sleep_stress_hormone2 = subject |&gt;
  select(id, birth_year, ethnicity) |&gt;
  mutate(age = 2025- birth_year) |&gt;
  full_join(sleep_stress_hormone, join_by(id)) </code></pre>
<p>View the stress and sleep score across menstrual cycle phases for
each</p>
<pre class="r"><code>sleep_stress_hormone2 |&gt;
  group_by(phase, study_interval, ethnicity) |&gt;
  summarize(
    mean_sleep_score = mean(overall_score, na.rm = TRUE),
    mean_stress_score = mean(stress_score, na.rm = TRUE),
    .groups = &quot;drop&quot;
  ) |&gt;
  pivot_longer(
    cols = starts_with(&quot;mean_&quot;),
    names_to = &quot;metric&quot;,
    values_to = &quot;value&quot;
  ) |&gt;
  drop_na()|&gt;
  mutate(
    metric = recode(metric,
                    mean_sleep_score  = &quot;Sleep Score&quot;,
                    mean_stress_score = &quot;Stress Score&quot;),
    phase = factor(phase, levels = phase_order)
  ) |&gt;
  ggplot(aes(x = phase, y = value, color = ethnicity, group = ethnicity)) +
    geom_line(size = 1) +
    geom_point(size = 3) +
    facet_grid(study_interval ~ metric) +
    labs(color = &quot;Ethnicity&quot;, y = &quot;Mean Score&quot;, x = &quot;Phase&quot;) +
    labs(
    title = &quot;stress and sleep score Across Menstrual Cycle Phases&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;score&quot;
  ) +
    theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-11-1.png" width="672" />
variation of sleep score and stress score across different ethnicity</p>
<pre class="r"><code>sleep_stress_hormone2 |&gt;
  select(id, ethnicity, stress_score, overall_score) |&gt;
  drop_na()|&gt;
  pivot_longer(
    cols = c(stress_score, overall_score),
    names_to = &quot;metric&quot;,
    values_to = &quot;value&quot;
  ) |&gt;
  mutate(
    metric = recode(metric,
      overall_score = &quot;Sleep Score&quot;,
      stress_score  = &quot;Stress Score&quot;
    )
  ) |&gt;
  ggplot(aes(x = ethnicity, y = value, fill = metric)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  labs(y = &quot;Score&quot;, fill = &quot;Metric&quot;)</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>library(lme4)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## 
## Attaching package: &#39;lme4&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:nlme&#39;:
## 
##     lmList</code></pre>
<pre class="r"><code>#  model
m1 &lt;- lmer(stress_score ~ phase + study_interval + (1 | id), data = sleep_stress_hormone2)
summary(m1)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: stress_score ~ phase + study_interval + (1 | id)
##    Data: sleep_stress_hormone2
## 
## REML criterion at convergence: 25467.2
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -12.2890  -0.5480   0.0429   0.6122   2.7105 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  id       (Intercept) 13.29    3.646   
##  Residual             42.21    6.497   
## Number of obs: 3852, groups:  id, 36
## 
## Fixed effects:
##                 Estimate Std. Error t value
## (Intercept)    958.58490  265.99425   3.604
## phaseFertility  -0.86808    0.30820  -2.817
## phaseLuteal     -0.92857    0.28599  -3.247
## phaseMenstrual  -0.04541    0.32905  -0.138
## study_interval  -0.43592    0.13150  -3.315
## 
## Correlation of Fixed Effects:
##             (Intr) phsFrt phsLtl phsMns
## phaseFrtlty  0.023                     
## phaseLuteal  0.007  0.540              
## phaseMnstrl  0.010  0.478  0.516       
## study_ntrvl -1.000 -0.024 -0.008 -0.011</code></pre>
<pre class="r"><code>sleep_stress_hormone_add =
  sleep_score1 |&gt;
    inner_join(hormone1,      by = join_by(id, day_in_study)) |&gt;
    inner_join(sleep1,        by = join_by(id, study_interval, day_in_study)) |&gt;
    inner_join(stress_score1, by = join_by(id, study_interval, day_in_study))</code></pre>
<pre><code>## Warning in inner_join(inner_join(sleep_score1, hormone1, by = join_by(id, : Detected an unexpected many-to-many relationship between `x` and `y`.
## ℹ Row 8 of `x` matches multiple rows in `y`.
## ℹ Row 30 of `y` matches multiple rows in `x`.
## ℹ If a many-to-many relationship is expected, set `relationship =
##   &quot;many-to-many&quot;` to silence this warning.</code></pre>
<pre class="r"><code># create a table
sleep_stress_hormone_add |&gt;
  group_by(phase, id) |&gt;
  summarize(
    timeinbed = mean(timeinbed/60)
  )|&gt;
  pivot_wider(names_from = phase,
              values_from = timeinbed) |&gt;
  knitr::kable(title = &quot;average time in bed&quot;, digits = 1)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;phase&#39;. You can override using the
## `.groups` argument.</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="right">Follicular</th>
<th align="right">Fertility</th>
<th align="right">Luteal</th>
<th align="right">Menstrual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">8.0</td>
<td align="right">8.4</td>
<td align="right">6.8</td>
<td align="right">5.3</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">5.3</td>
<td align="right">4.7</td>
<td align="right">4.7</td>
<td align="right">5.6</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">7.3</td>
<td align="right">6.8</td>
<td align="right">6.5</td>
<td align="right">6.9</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">7.5</td>
<td align="right">7.1</td>
<td align="right">7.7</td>
<td align="right">7.7</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">6.8</td>
<td align="right">7.7</td>
<td align="right">6.0</td>
<td align="right">7.0</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">7.4</td>
<td align="right">7.7</td>
<td align="right">6.9</td>
<td align="right">6.7</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">7.5</td>
<td align="right">7.3</td>
<td align="right">6.8</td>
<td align="right">7.8</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">7.1</td>
<td align="right">7.3</td>
<td align="right">6.8</td>
<td align="right">7.4</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">6.9</td>
<td align="right">6.5</td>
<td align="right">7.5</td>
<td align="right">7.2</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">7.6</td>
<td align="right">7.5</td>
<td align="right">7.2</td>
<td align="right">7.8</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">5.2</td>
<td align="right">5.9</td>
<td align="right">6.4</td>
<td align="right">6.5</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">7.3</td>
<td align="right">6.5</td>
<td align="right">7.2</td>
<td align="right">7.3</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">6.5</td>
<td align="right">7.0</td>
<td align="right">6.8</td>
<td align="right">7.1</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">7.7</td>
<td align="right">7.4</td>
<td align="right">7.2</td>
<td align="right">6.9</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">6.3</td>
<td align="right">7.3</td>
<td align="right">7.3</td>
<td align="right">7.6</td>
</tr>
<tr class="even">
<td align="right">24</td>
<td align="right">4.9</td>
<td align="right">5.0</td>
<td align="right">4.4</td>
<td align="right">4.7</td>
</tr>
<tr class="odd">
<td align="right">26</td>
<td align="right">6.7</td>
<td align="right">6.4</td>
<td align="right">6.1</td>
<td align="right">6.7</td>
</tr>
<tr class="even">
<td align="right">27</td>
<td align="right">5.6</td>
<td align="right">5.7</td>
<td align="right">6.6</td>
<td align="right">6.7</td>
</tr>
<tr class="odd">
<td align="right">29</td>
<td align="right">6.2</td>
<td align="right">5.6</td>
<td align="right">5.2</td>
<td align="right">8.4</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">6.8</td>
<td align="right">6.6</td>
<td align="right">7.1</td>
<td align="right">6.8</td>
</tr>
<tr class="odd">
<td align="right">32</td>
<td align="right">7.4</td>
<td align="right">7.2</td>
<td align="right">6.6</td>
<td align="right">7.7</td>
</tr>
<tr class="even">
<td align="right">33</td>
<td align="right">7.0</td>
<td align="right">7.2</td>
<td align="right">7.0</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td align="right">34</td>
<td align="right">7.8</td>
<td align="right">7.1</td>
<td align="right">7.0</td>
<td align="right">6.9</td>
</tr>
<tr class="even">
<td align="right">37</td>
<td align="right">6.2</td>
<td align="right">6.1</td>
<td align="right">7.7</td>
<td align="right">4.8</td>
</tr>
<tr class="odd">
<td align="right">38</td>
<td align="right">7.3</td>
<td align="right">7.2</td>
<td align="right">7.1</td>
<td align="right">7.1</td>
</tr>
<tr class="even">
<td align="right">39</td>
<td align="right">6.8</td>
<td align="right">5.3</td>
<td align="right">5.8</td>
<td align="right">5.9</td>
</tr>
<tr class="odd">
<td align="right">40</td>
<td align="right">7.8</td>
<td align="right">6.9</td>
<td align="right">6.6</td>
<td align="right">7.6</td>
</tr>
<tr class="even">
<td align="right">41</td>
<td align="right">7.6</td>
<td align="right">6.8</td>
<td align="right">7.7</td>
<td align="right">7.5</td>
</tr>
<tr class="odd">
<td align="right">42</td>
<td align="right">6.6</td>
<td align="right">6.4</td>
<td align="right">7.1</td>
<td align="right">7.0</td>
</tr>
<tr class="even">
<td align="right">43</td>
<td align="right">6.2</td>
<td align="right">7.0</td>
<td align="right">7.3</td>
<td align="right">7.4</td>
</tr>
<tr class="odd">
<td align="right">44</td>
<td align="right">7.5</td>
<td align="right">7.4</td>
<td align="right">6.8</td>
<td align="right">7.3</td>
</tr>
<tr class="even">
<td align="right">46</td>
<td align="right">6.7</td>
<td align="right">5.8</td>
<td align="right">5.6</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td align="right">47</td>
<td align="right">7.2</td>
<td align="right">6.9</td>
<td align="right">7.5</td>
<td align="right">7.4</td>
</tr>
<tr class="even">
<td align="right">48</td>
<td align="right">6.7</td>
<td align="right">6.5</td>
<td align="right">7.2</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="right">7.0</td>
<td align="right">7.1</td>
<td align="right">6.9</td>
<td align="right">7.0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">7.9</td>
<td align="right">3.2</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<pre class="r"><code>sleep_stress_hormone_add |&gt;
  group_by(phase, id) |&gt;
  summarize(
    timeinbed = mean(timeinbed/60)
  )|&gt; 
  ggplot(aes(x = phase, y = timeinbed, fill = phase)) +
  geom_violin(alpha = 0.5) +
  geom_boxplot(width = 0.2) +
  labs(
    title = &quot;Sleep time Across Menstrual Cycle Phases&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Time in bed (hrs)&quot;
  ) +
    theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;phase&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>See the correlation in sleep score file</p>
<pre class="r"><code>sleep_score |&gt;
  group_by(id)|&gt;
  summarise(mean_deep_sleep = mean(deep_sleep_in_minutes),
            mean_overall_score = mean(overall_score))|&gt;
  ggplot(aes(x= mean_overall_score, y = mean_deep_sleep )) +
  geom_point()</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>NOT WORKING_try to put all in one scale</p>
<p>See time in bed and deep sleep vs menstrual cycle</p>
<pre class="r"><code>sleep_stress_hormone_add |&gt;
  group_by(phase)|&gt;
   summarize(timeinbed = mean(timeinbed/60, na.rm = TRUE),
             deep_sleep_in_minutes = mean(deep_sleep_in_minutes/60, na.rm = TRUE)
             )|&gt;
  ggplot(aes(x= phase)) +
  geom_line(aes( y = deep_sleep_in_minutes, group = 1),color = &quot;blue&quot;,  linewidth = 0.8) +
  geom_line(aes(y = timeinbed, group = 1), color = &quot;red&quot;, linewidth = 0.8)</code></pre>
<p><img src="sleep_stress_khue_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
