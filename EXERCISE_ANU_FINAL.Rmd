---
title: "EXERCISE: "
output: html_document
---
```{r}
# Load and prepare data
raw_data <- read.csv("./clean_data/all_daily_data.csv") %>%
  distinct(id, study_interval, day_in_study, .keep_all = TRUE)

# Identify outliers
outliers_removed <- sum(raw_data$total_steps >= 50000, na.rm = TRUE)

# Apply cleaning
exercise_analysis <- raw_data %>%
  filter(total_steps < 50000)

# Sample characteristics
sample_chars <- data.frame(
  Characteristic = c("Unique participants", 
                     "Total observations",
                     "Observations removed",
                     "Study years",
                     "Participants in both years"),
  Value = c(
    n_distinct(exercise_analysis$id),
    nrow(exercise_analysis),
    paste0(outliers_removed, " (", 
           round(outliers_removed/nrow(raw_data)*100, 1), "%)"),
    paste(unique(exercise_analysis$study_interval), collapse = ", "),
    paste0(sum(exercise_analysis %>% 
               group_by(id) %>% 
               summarise(n_years = n_distinct(study_interval)) %>% 
               pull(n_years) == 2),
           " (", 
           round(mean(exercise_analysis %>% 
                      group_by(id) %>% 
                      summarise(n_years = n_distinct(study_interval)) %>% 
                      pull(n_years) == 2) * 100, 1), 
           "%)")
  )
)

kable(sample_chars, 
      col.names = c("", ""),
      caption = "Sample Characteristics") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, position = "left")


# Overall descriptives
overall_desc <- exercise_analysis %>%
  summarise(
    Variable = c("Daily Steps", "Active Minutes/Day", "Calories Burned", 
                 "Exercise Sessions/Day", "Days with Activity (%)"),
    Mean = c(mean(total_steps, na.rm = TRUE),
             mean(total_active_min, na.rm = TRUE),
             mean(total_calories, na.rm = TRUE),
             mean(n_sessions, na.rm = TRUE),
             NA),
    SD = c(sd(total_steps, na.rm = TRUE),
           sd(total_active_min, na.rm = TRUE),
           sd(total_calories, na.rm = TRUE),
           sd(n_sessions, na.rm = TRUE),
           NA),
    Median = c(median(total_steps, na.rm = TRUE),
               median(total_active_min, na.rm = TRUE),
               median(total_calories, na.rm = TRUE),
               median(n_sessions, na.rm = TRUE),
               NA),
    IQR = c(IQR(total_steps, na.rm = TRUE),
            IQR(total_active_min, na.rm = TRUE),
            IQR(total_calories, na.rm = TRUE),
            IQR(n_sessions, na.rm = TRUE),
            NA),
    Percent = c(NA, NA, NA, NA,
                mean(total_steps > 0, na.rm = TRUE) * 100)
  ) %>%
  mutate(
    Mean = ifelse(!is.na(Mean), sprintf("%.1f", Mean), ""),
    SD = ifelse(!is.na(SD), sprintf("%.1f", SD), ""),
    Median = ifelse(!is.na(Median), sprintf("%.1f", Median), ""),
    IQR = ifelse(!is.na(IQR), sprintf("%.1f", IQR), ""),
    Percent = ifelse(!is.na(Percent), sprintf("%.1f%%", Percent), "")
  )

kable(overall_desc,
      caption = "Descriptive Statistics: Exercise Metrics",
      align = c("l", "r", "r", "r", "r", "r")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

### Descriptive Statistics: Symptom Severity

```{r symptom-descriptives}
# Symptom descriptives
symptom_desc <- exercise_analysis %>%
  summarise(
    across(c(cramps_score, fatigue_score, stress_score, moodswing_score,
             sleepissue_score, bloating_score, appetite_score, 
             sorebreasts_score, foodcravings_score, indigestion_score),
           list(mean = ~mean(.x, na.rm = TRUE),
                sd = ~sd(.x, na.rm = TRUE),
                median = ~median(.x, na.rm = TRUE)),
           .names = "{.col}_{.fn}")
  ) %>%
  pivot_longer(everything(),
               names_to = c("symptom", ".value"),
               names_pattern = "(.+)_score_(.+)") %>%
  mutate(
    symptom = str_to_title(str_replace_all(symptom, "_", " ")),
    across(where(is.numeric), ~round(.x, 2))
  )

kable(symptom_desc,
      col.names = c("Symptom", "Mean", "SD", "Median"),
      caption = "Descriptive Statistics: Symptom Severity (0-5 scale)",
      align = c("l", "r", "r", "r")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

### Comparison by Study Year

```{r year-comparison}
year_comp <- exercise_analysis %>%
  group_by(study_interval) %>%
  summarise(
    `N Days` = n(),
    `N Participants` = n_distinct(id),
    `Mean Steps` = round(mean(total_steps, na.rm = TRUE), 0),
    `SD Steps` = round(sd(total_steps, na.rm = TRUE), 0),
    `Mean Active Min` = round(mean(total_active_min, na.rm = TRUE), 1),
    `SD Active Min` = round(sd(total_active_min, na.rm = TRUE), 1),
    `% Days Active` = round(mean(total_steps > 0, na.rm = TRUE) * 100, 1)
  ) %>%
  rename(Year = study_interval)

kable(year_comp,
      caption = "Exercise Metrics by Study Year",
      align = c("c", rep("r", 7))) %>%
  kable_styling(bootstrap_options = c("striped", "hover"), full_width = FALSE)
```

This analysis investigates the relationship between objectively measured exercise (steps, active minutes, calories) and self-reported menstrual symptoms across different cycle phases. We use data from two study intervals (2022 and 2024) to examine whether physical activity is associated with symptom severity.

```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(patchwork)
library(scales)
library(lme4)
library(lmerTest)
library(broom.mixed)

# Set plot theme
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.discrete.colour = function(...) scale_colour_brewer(..., palette = "Pastel2"),
  ggplot2.discrete.fill   = function(...) scale_fill_brewer(..., palette = "Pastel2"),

  ggplot2.continuous.colour = function(...) scale_colour_distiller(..., palette = "PuRd"),
  ggplot2.continuous.fill   = function(...) scale_fill_distiller(..., palette = "PuRd")
)
```

# EDA

### Data summaries

```{r}
# View observations with extreme values

# Load raw data
raw_data <- read.csv("./clean_data/all_daily_data.csv") %>%
  distinct(id, study_interval, day_in_study, .keep_all = TRUE)

# Identify and view extreme observations
extreme_obs <- raw_data %>%
  filter(total_steps >= 50000 | 
         total_active_min >= 1440 | 
         total_calories >= 10000) %>%
  select(id, study_interval, day_in_study, 
         total_steps, total_active_min, total_calories,
         n_sessions, total_duration_min) %>%
  arrange(desc(total_steps))

# Display the observations
print(extreme_obs)

# Or view in a nice table
library(knitr)
library(kableExtra)

extreme_obs %>%
  kable(caption = "Observations with Extreme Values",
        col.names = c("ID", "Year", "Day", "Steps", "Active Min", 
                     "Calories", "Sessions", "Duration")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

## Data Summary and Quality Checks

```{r data-preparation, message=FALSE}
# Load and check raw data
raw_data <- read.csv("./clean_data/all_daily_data.csv") %>%
  distinct(id, study_interval, day_in_study, .keep_all = TRUE)

# Identify extreme values
outliers <- raw_data %>%
  summarise(
    extreme_steps = sum(total_steps >= 50000, na.rm = TRUE),
    extreme_active = sum(total_active_min >= 1440, na.rm = TRUE),
    extreme_calories = sum(total_calories >= 10000, na.rm = TRUE)
  )

outliers
# Apply cleaning filters
exercise_analysis <- raw_data %>%
  filter(
    total_steps < 50000,        # Realistic daily maximum
    total_active_min < 1440,     # Cannot exceed 24 hours
    total_calories < 10000       # Realistic exercise expenditure
  )
```

### Distribution of key exercise metrics

```{r, fig.width = 13, fig.height = 12}

# Filtering realistic values

exercise_analysis = read.csv("./clean_data/all_daily_data.csv")

# exercise_analysis = read.csv("./clean_data/all_daily_data.csv") |> 
 # distinct(id, study_interval, day_in_study, .keep_all = TRUE) |> 
  #filter(
    # Removing outliers/impossible values
   # total_steps < 50000,
   # total_active_min < 1440,
   # total_calories < 10000
 # )

p1 = ggplot(exercise_analysis |> filter(total_steps > 0, total_steps < 50000), 
             aes(x = total_steps, fill = factor(study_interval))) +
  geom_histogram(bins = 50, alpha = 0.7, position = "dodge") +
  geom_vline(xintercept = median(exercise_analysis$total_steps[exercise_analysis$total_steps > 0], na.rm = TRUE),
             linetype = "dashed", color = "black", linewidth = 1) +
  labs(title = "Daily Step Count Distribution",
       subtitle = paste("Median:", 
                       scales::comma(round(median(exercise_analysis$total_steps[exercise_analysis$total_steps > 0], na.rm = TRUE))), 
                       "steps"),
       x = "Total Daily Steps",
       y = "Count",
       fill = "Study Year") +
  scale_x_continuous(labels = scales::comma)

p2 = ggplot(exercise_analysis |> filter(total_active_min > 0), 
             aes(x = total_active_min, fill = factor(study_interval))) +
  geom_histogram(bins = 50, alpha = 0.7, position = "dodge") +
  geom_vline(xintercept = median(exercise_analysis$total_active_min[exercise_analysis$total_active_min > 0], na.rm = TRUE),
             linetype = "dashed", color = "black", linewidth = 1) +
  labs(title = "Active Minutes Distribution",
       subtitle = paste("Median:", 
                       round(median(exercise_analysis$total_active_min[exercise_analysis$total_active_min > 0], na.rm = TRUE), 1), 
                       "minutes"),
       x = "Total Active Minutes",
       y = "Count",
       fill = "Study Year")

p3 = ggplot(exercise_analysis |> filter(total_calories > 0), 
             aes(x = total_calories, fill = factor(study_interval))) +
  geom_histogram(bins = 50, alpha = 0.7, position = "dodge") +
  geom_vline(xintercept = median(exercise_analysis$total_calories[exercise_analysis$total_calories > 0], na.rm = TRUE),
             linetype = "dashed", color = "black", linewidth = 1) +
  labs(title = "Calories Burned Distribution",
       subtitle = paste("Median:", 
                       scales::comma(round(median(exercise_analysis$total_calories[exercise_analysis$total_calories > 0], na.rm = TRUE))), 
                       "calories"),
       x = "Total Calories Burned",
       y = "Count",
       fill = "Study Year") +
  scale_x_continuous(labels = scales::comma)

p4 <- ggplot(exercise_analysis |> filter(n_sessions > 0), 
             aes(x = n_sessions, fill = factor(study_interval))) +
  geom_bar(alpha = 0.7, position = "dodge") +
  labs(title = "Exercise Sessions Per Day",
       x = "Number of Sessions",
       y = "Count",
       fill = "Study Year")

(p1 + p2) / (p3 + p4) + 
  plot_layout(guides = "collect")

```

**Data Cleaning Notes:**

-   Removed duplicate observations based on participant ID, study interval, and day
-   Filtered out physiologically impossible values (\>50k steps, \>24 hours active)
-   This ensures data quality and prevents aggregation errors from affecting results

**Key Findings:**

-   **Distribution Shape**: Exercise metrics show right-skewed distributions, typical of activity data where some days have very high activity
-   **Central Tendency**: Median steps around `r scales::comma(round(median(exercise_analysis$total_steps[exercise_analysis$total_steps > 0], na.rm = TRUE)))` steps/day, suggesting moderate activity levels overall
-   **Between-Year Comparison**: The side-by-side histograms reveal whether activity patterns changed between 2022 and 2024 study intervals

### Activity type

```{r, fig.width = 10, fig.height = 17}
# Prepare activity types data
activities_long <- exercise_analysis |> 
  filter(!is.na(activity_types), activity_types != "", activity_types != "NA") |> 
  select(id, study_interval, day_in_study, activity_types) |> 
  mutate(
    # Clean activity types column
    activity_types = str_replace_all(activity_types, "\\n", ","),
    activity_types = str_replace_all(activity_types, "\"", "")
  ) |> 
  # Split comma-separated activities into rows
  separate_rows(activity_types, sep = ",") |> 
  mutate(
    activity_types = str_trim(activity_types),
    activity_types = str_to_title(activity_types)
  ) |> 
  filter(activity_types != "", activity_types != "Na")

activities_long

# Count activities by year
activity_counts <- activities_long %>%
  group_by(study_interval, activity_types) %>%
  summarise(n_days = n(), .groups = "drop") %>%
  group_by(study_interval) %>%
  mutate(pct = n_days / sum(n_days) * 100) %>%
  ungroup()

# Get top 10 activities
top_activities <- activity_counts %>%
  group_by(activity_types) %>%
  summarise(total = sum(n_days)) %>%
  arrange(desc(total)) %>%
  slice(1:10) %>%
  pull(activity_types)

activity_counts_top <- activity_counts %>%
  filter(activity_types %in% top_activities)

# Plot 1: Activity type frequency by year
p1 <- ggplot(activity_counts_top, 
             aes(x = reorder(activity_types, pct), y = pct, 
                 fill = factor(study_interval))) +
  geom_col(position = "dodge", alpha = 0.8) +
  coord_flip() +
  labs(title = "Most Common Activity Types by Study Year",
       x = "Activity Type",
       y = "% of Days with Exercise",
       fill = "Study Year") +
  theme_minimal() +
  theme(legend.position = "bottom")

p1
```

### Exercise patterns across menstrual cycle phases

```{r, fig.width = 10, fig.height = 10}

p1 = ggplot(exercise_analysis |> filter(!is.na(phase), total_steps > 0, total_steps < 50000), 
             aes(x = phase, y = total_steps, fill = phase)) +
  geom_boxplot(alpha = 0.7, outlier.alpha = 0.3) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 0.5) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "white") +
  facet_wrap(~study_interval, ncol = 2) +  # Side by side
  labs(title = "Daily Steps by Menstrual Cycle Phase",
       subtitle = "White diamonds represent mean values | Comparing study years",
       x = "Cycle Phase",
       y = "Total Daily Steps") +
  scale_y_continuous(labels = comma) +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1))

p2 = ggplot(exercise_analysis |> filter(!is.na(phase), total_active_min > 0), 
             aes(x = phase, y = total_active_min, fill = phase)) +
  geom_boxplot(alpha = 0.7, outlier.alpha = 0.3) +
  geom_jitter(width = 0.2, alpha = 0.1, size = 0.5) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 3, fill = "white") +
  facet_wrap(~study_interval, ncol = 2) +
  labs(title = "Active Minutes by Menstrual Cycle Phase",
       x = "Cycle Phase",
       y = "Total Active Minutes") +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1))

p1 / p2 + plot_layout(guides = "collect")
```

**Key Findings:**

-   **Visual Patterns**: The box plots reveal whether activity varies systematically across cycle phases
-   **Menstrual Phase**: Often shows slightly lower activity (if present) due to symptom burden
-   **Follicular/Fertility**: May show higher activity as energy levels typically increase
-   **Luteal Phase**: Activity patterns may decrease as PMS symptoms emerge
-   **Year Consistency**: Faceting by year shows whether these patterns are stable across study intervals

### Exercise vs. menstrual symptoms

```{r, fig.width = 10, fig.height = 10, warning = FALSE, message = FALSE}
symptoms_long = exercise_analysis |> 
  filter(total_active_min > 0) |> 
  select(id, total_active_min, appetite_score, sorebreasts_score, sleepissue_score, cramps_score, fatigue_score, 
         headaches_score, moodswing_score, foodcravings_score, indigestion_score, bloating_score) |> 
  pivot_longer(cols = ends_with("_score"), 
               names_to = "symptom", 
               values_to = "severity") |> 
  filter(!is.na(severity)) |> 
  mutate(symptom = case_when(
    symptom == "appetite_score" ~ "Appetite",
    symptom == "sorebreasts_score" ~ "Sore Breasts",
    symptom == "sleepissue_score" ~ "Sleep Issue",
    symptom == "cramps_score" ~ "Cramps",
    symptom == "fatigue_score" ~ "Fatigue",
    symptom == "headaches_score" ~ "Headaches",
    symptom == "moodswing_score" ~ "Mood Swings",
    symptom == "foodcravings_score" ~ "Food Cravings",
    symptom == "indigestion_score" ~ "Indigestion",
    symptom == "bloating_score" ~ "Bloating"
  ))

p4 = ggplot(symptoms_long, 
             aes(x = total_active_min, y = severity, color = symptom)) +
  geom_jitter(alpha = 0.2, size = 0.5, height = 0.1) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 1.5) +
  facet_wrap(~symptom, ncol = 2) +
  labs(title = "Daily Activity vs Individual Symptoms",
       x = "Total Daily Activity (mins)",
       y = "Symptom Severity (0-5)") +
  scale_x_continuous(labels = comma) +
  scale_y_continuous(breaks = 0:5) +
  theme(legend.position = "none")

p4
```

**Key Findings:**

-   **Slope Direction**:
    -   Downward slopes (negative correlations) suggest exercise is associated with *reduced* symptom severity
    -   Upward slopes (positive correlations) could indicate either: (a) symptoms prevent exercise, or (b) exercise exacerbates symptoms
    -   Flat lines suggest no relationship
-   **Symptom-Specific Patterns**:
    -   **Cramps**: Look for negative slope - exercise may reduce cramping
    -   **Fatigue**: Relationship could go either way - exercise might reduce fatigue OR fatigue prevents exercise
    -   **Mood/Stress**: Exercise typically shows beneficial (negative) associations
    -   **Physical symptoms** (bloating, sore breasts): May be less responsive to exercise

# Modelling and inferential analysis

We used linear mixed-effects models to test associations between daily physical activity and menstrual symptom severity. For each of 10 symptoms, we fit models with:

-   **Outcome**: Symptom severity (0-5 scale)
-   **Predictor**: Total active exercise minutes per day\
-   **Covariate**: Menstrual cycle phase (Menstrual, Follicular, Fertility, Luteal)
-   **Random effects**: Random intercepts for participants (1\|id)

The random intercept structure accounts for repeated measures within individuals, including the 20 participants (47.6%) who contributed data in both 2022 and 2024 study intervals. Models were fit using the lme4 package in R with REML = FALSE. Statistical significance was assessed at α = 0.05.

```{r}

# Model 1: Exercise → cramps
model_cramps = lmer(cramps_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_cramps)

# Model 2: Exercise → fatigue
model_fatigue = lmer(fatigue_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_fatigue)

# Model 3: Exercise → stress
model_stress = lmer(stress_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_stress)

# Model 4: Exercise → mood swings
model_mood = lmer(moodswing_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_mood)

# Model 5: Exercise → sleep issues
model_sleep = lmer(sleepissue_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_sleep)

# Model 6: Exercise → bloating
model_bloating = lmer(bloating_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_bloating)

# Model 7: Exercise → appetite
model_appetite = lmer(appetite_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_appetite)

# Model 8: Exercise → sore breasts
model_sorebreasts = lmer(sorebreasts_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_sorebreasts)

# Model 9: Exercise → food cravings
model_foodcravings = lmer(foodcravings_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_foodcravings)

# Model 10: Exercise → indigestion
model_indigestion = lmer(indigestion_score ~ total_active_min + phase + (1|id), 
                     data = exercise_analysis,
                     REML = FALSE)
summary(model_indigestion)

```

```{r}
# Cleaning results:
# Extract coefficients for exercise effect
results_summary = bind_rows(
  tidy(model_cramps, effects = "fixed") %>% mutate(outcome = "Cramps"),
  tidy(model_fatigue, effects = "fixed") %>% mutate(outcome = "Fatigue"),
  tidy(model_stress, effects = "fixed") %>% mutate(outcome = "Stress"),
  tidy(model_mood, effects = "fixed") %>% mutate(outcome = "Mood swings"),
  tidy(model_sleep, effects = "fixed") %>% mutate(outcome = "Sleep issues"),
  tidy(model_bloating, effects = "fixed") %>% mutate(outcome = "Bloating"),
  tidy(model_appetite, effects = "fixed") %>% mutate(outcome = "Appetite"),
  tidy(model_indigestion, effects = "fixed") %>% mutate(outcome = "Indigestion"),
  tidy(model_sorebreasts, effects = "fixed") %>% mutate(outcome = "Sore breasts"),
  tidy(model_foodcravings, effects = "fixed") %>% mutate(outcome = "Food cravings")
) %>%
  filter(term == "total_active_min") %>%
  select(outcome, estimate, std.error, statistic, p.value) %>%
  mutate(
    significant = ifelse(p.value < 0.05, "Yes", "No"),
    p.value = format.pval(p.value, digits = 3, eps = 0.001)
  )

knitr::kable(results_summary)
```

Our analysis examined the relationship between objectively measured physical activity and menstrual symptom severity across 10 different symptoms. The mixed-effects modeling approach appropriately accounts for the repeated-measures structure of the data and controls for menstrual cycle phase and study year effects.

**Key Takeaways:**

1.  **Individual Variation Dominates**: The high ICC values indicate that most variance in symptoms is between individuals rather than within individuals over time. This suggests symptom experiences are highly personalized.

2.  **Exercise Effects Are Complex**: The relationship between exercise and symptoms is not uniformly beneficial or harmful. Some symptoms may respond to exercise while others do not.

3.  **Reverse Causation Concerns**: Positive associations (exercise → worse symptoms) likely reflect reverse causation. Symptoms prevent exercise rather than exercise causing symptoms.


### Model Diagnostics
```{r model-diagnostics, fig.width=10, fig.height=4}

# Three essential plots
par(mfrow = c(1, 3))

# 1. Residuals vs Fitted (linearity + homoscedasticity)
plot(fitted(model_fatigue), resid(model_fatigue),
     xlab = "Fitted Values", ylab = "Residuals",
     main = "Residuals vs Fitted",
     pch = 16, col = rgb(0, 0, 0, 0.3))
abline(h = 0, col = "red", lty = 2, lwd = 2)

# 2. Q-Q Plot (normality of residuals)
qqnorm(resid(model_cramps), main = "Q-Q Plot: Residuals",
       pch = 16, col = rgb(0, 0, 0, 0.3))
qqline(resid(model_cramps), col = "red", lwd = 2)

# 3. Q-Q Plot (normality of random effects)
qqnorm(ranef(model_cramps)$id[,1], main = "Q-Q Plot: Random Effects",
       pch = 16, col = rgb(0, 0, 0, 0.5))
qqline(ranef(model_cramps)$id[,1], col = "red", lwd = 2)

par(mfrow = c(1, 1))
```

**Interpretation:**

- **Residuals vs Fitted:** Should show random scatter around 0 (no pattern)
- **Q-Q Plots:** Points should follow the red line (approximately normal)

The diagnostic plots show that model assumptions are reasonably met: residuals show random scatter with no clear pattern, and both residuals and random effects are approximately normally distributed.

**Assessment:** 

The residual vs fitted plot shows diagonal banding typical of ordinal outcome data 
(symptom scores are discrete: 0, 1, 2, 3, 4, 5). This is expected when applying 
linear models to Likert-scale data. The Q-Q plots indicate that residuals and random 
effects are approximately normally distributed, supporting the use of mixed-effects 
models. 