---
title: "HORMONES & SYMPTOMS: STATISTICAL MODELLING"
output:
  html_document:
    code_folding: hide 
---
```{r, include=FALSE}
library(tidyverse)
library(broom)
library(broom.mixed)
library(lme4)
# Set plot theme
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.discrete.colour = function(...) scale_colour_brewer(..., palette = "Pastel2"),
  ggplot2.discrete.fill   = function(...) scale_fill_brewer(..., palette = "Pastel2"),

  ggplot2.continuous.colour = function(...) scale_colour_distiller(..., palette = "PuRd"),
  ggplot2.continuous.fill   = function(...) scale_fill_distiller(..., palette = "PuRd")
)
```

Mood SwingLinear Mixed Models

Test whether mood swing and fatigue differ by menstrual phase, accounting for repeated measures.
```{r, echo=FALSE}
mood_mixed_model <- lmer(moodswing_score ~ phase + (1 | id), data = hormone_symptoms)


create_model_table <- function(model, model_name) {
  # Get tidy output
  tidy_output <- tidy(model, effects = "fixed", conf.int = TRUE)
  
  # Extract p-values from model summary
  p_values <- summary(model)$coefficients[, ncol(summary(model)$coefficients)]
  
  # Create the table
  table <- tidy_output %>%
    select(term, estimate, std.error, conf.low, conf.high) %>%
    mutate(
      p.value = p_values[match(term, names(p_values))],
      significant = ifelse(p.value < 0.05, "Yes", "No"),
      model = model_name
    ) %>%
    select(model, everything())
  
  return(table)
}


mood_table <- create_model_table(mood_mixed_model, "Mood Swing ~ Phase")|>
  knitr::kable(digits = 3)
mood_table


```

Mood swings are lowest near ovulation, slightly higher in Luteal, and peak during Menstrual phase. Fatigue shows a similar pattern: lowest near ovulation, increasing through Luteal, highest during Menstrual phase. Random effects indicate that some individuals are chronically more fatigued or mood-sensitive than others, while residual variance captures day-to-day variability.
Linear Mixed Model

Flow volume vs lh

Observing in exploratory scatter plots that self-reported flow volume scores appeared to follow an inverse pattern relative to luteinizing hormone (LH) levels, I conducted a linear mixed model analysis to formally test this visual hypothesis. The model was used to determine if this apparent inverse relationship was statistically significant when rigorously accounting for the repeated measures within each individual participant.

```{r}
flow_volume_model <- lmer(flow_volume_score ~ lh + (1 | id), data = hormone_symptoms)
flow_table <- create_model_table(flow_volume_model, "Flow Volume ~ LH")|>
  knitr::kable(digits = 3)
flow_table
```

Based on the linear mixed model, a significant but modest relationship exists between luteinizing hormone (LH) levels and perceived menstrual flow volume. For every one-unit increase in LH, the flow volume score is estimated to decrease by -0.01138 points (p = 0.00129). While statistically significant, this effect is small in magnitude. The model indicates substantial individual differences, as the variation in scores within a single person over time (residual SD = 1.19) is much greater than the average differences between individuals' baselines (intercept SD = 0.45). Therefore, while LH shows a significant inverse association with flow volume, within-person biological and measurement variability remains the dominant feature of the data.


### Appetite

Average Appetite Across Phases

Summarize average appetite to observe general trends across the menstrual cycle.
```{r, echo=FALSE}
# Appetite
ggplot(cycle_avg, aes(x = phase, y = avg_appetite, group = 1)) +
  geom_line(aes(color = "Appetite"),size = 1.2, show.legend = FALSE) +
  geom_point(aes(color = "Appetite"),size = 3, show.legend = FALSE) +
  geom_text(aes(label = round(avg_appetite, 2)), vjust = -1, size = 4, fontface = "bold") +
  labs(title = "Average Appetite Across Phases",
       x = "Phase", y = "Appetite Score") +
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = "bold"),
    panel.grid.major = element_line(color = "grey90")
  )
```
Appetite is highest in Fertility (2.96), lowest in Follicular (2.85), Luteal 2.95, Menstrual 2.90.

Linear Mixed Model: Appetite vs Estrogen
Explore the relationship between estrogen levels and appetite scores, accounting for repeated measures.
```{r, echo=FALSE}

appetite_model <- lmer(appetite_score ~ estrogen + (1 | id), data = hormone_symptoms)
appetite_table <- create_model_table(appetite_model, "Appetite ~ Estrogen")|>
  knitr::kable(digits = 3)
appetite_table
```
Random intercept variance (0.1746) indicates participant-specific baseline appetite differences. The fixed effect of estrogen is small (0.00013 per unit) and not significant (t = 0.869).




limitation:

Several limitations should be considered when interpreting these findings. First, the dataset relies on self-reported symptom scores, which may be subject to recall bias or subjective interpretation. Second, while repeated measures are accounted for using linear mixed models, the sample size for some phases may be limited, reducing statistical power to detect subtle effects. Finally, other biological and lifestyle factors—such as stress, sleep, diet, and physical activity—were not controlled for, which could influence mood, appetite, and fatigue. Therefore, the results should be interpreted as suggestive of phase-related trends rather than definitive causal effects.
