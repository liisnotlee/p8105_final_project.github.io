---
title: "hormone_final"
output: html_document
date: "2025-12-03"
---
```{r, include=FALSE}
library(tidyverse)
library(broom)

library(lme4)
```

```{r, include=FALSE}
hormone_symptoms=
  read_csv("clean_data/hormone_symptoms.csv")|>
  janitor::clean_names()|>
  filter(!is.na(phase) & !is.na(moodswing) & !is.na(fatigue)& !is.na(flow_color)& !is.na(flow_volume)& !is.na(appetite))
```

###LH & Estrogen Across Phases
Topic: Examine average estrogen and LH levels across menstrual cycle phases to see if hormonal patterns match biological expectations
```{r, echo=FALSE}
hormone_avg <- hormone_symptoms |>
  group_by(phase) |>
  summarise(
    estrogen_mean = mean(estrogen, na.rm = TRUE),
    lh_mean = mean(lh, na.rm = TRUE),
    .groups = "drop"
  )

ggplot(hormone_avg, aes(x = phase)) +
  geom_line(aes(y = estrogen_mean, color = "Estrogen", group = 1), size = 1) +
  geom_line(aes(y = lh_mean, color = "LH", group = 1), size = 1) +
  geom_point(aes(y = estrogen_mean, color = "Estrogen"), size = 3) +
  geom_point(aes(y = lh_mean, color = "LH"), size = 3) +
  labs(title = "Average Estrogen and LH Across Cycle",
       x = "Phase", y = "Hormone Level", color = "Hormone") +
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = "bold"),
    panel.grid.major = element_line(color = "grey90")
  )
```
EDA: Estrogen levels are highest in the Fertility (ovulatory) phase, second highest in Luteal, and relatively low in Menstrual, gradually rising from Follicular to Luteal. LH is much lower than estrogen overall, peaking sharply in Fertility and remaining low in the other phases.

Discussion: These patterns are consistent with established physiology. The LH surge triggers ovulation during Fertility, while estrogen gradually rises through Follicular phase, peaks in Fertility, and remains moderate in Luteal. Menstrual phase shows low hormone levels, reflecting the hormonal reset.

###Mood Swing Distribution Across Phases
Topic: Assess whether menstrual cycle phases influence mood swing intensity using violin plots.
```{r, echo=FALSE}
# Mood swing
ggplot(hormone_symptoms, aes(x = phase, y = moodswing_score)) +
  geom_violin(trim = TRUE, fill = "orchid", alpha = 0.5) +
  geom_jitter(width = 0.15, alpha = 0.3, size = 1) +
  scale_y_continuous(limits = c(0,5), breaks = 0:5) +
  labs(
    title = "Distribution of Mood Swing Intensity Across Phases",
    x = "Phase",
    y = "Mood Swing (0–5)"
  ) +
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = "bold"),
    panel.grid.major = element_line(color = "grey90")
  )

```
EDA: Violin plots show substantial inter-individual variability. Menstrual phase has the highest mood swing intensity (right-skewed distribution, peak around 1.85), while Luteal phase shows lower values with a wider base (more individuals with low mood swing).

Discussion: (Mood Swing Distribution Across Phases)This distribution suggests that mood swings are most severe during menstruation, likely due to the simultaneous withdrawal of estrogen and progesterone. Luteal phase has moderate symptom expression, consistent with premenstrual hormonal shifts.




Average Mood Swing Across Phases

Topic: Summarize average mood swing intensity across phases to visualize general trends.
```{r, echo=FALSE}
symptom_means <- hormone_symptoms |>
  group_by(phase) |>
  summarise(
    avg_moodswing = mean(moodswing_score, na.rm = TRUE),
    .groups = "drop"
  )

# Mood swing single line plot
ggplot(symptom_means, aes(x = phase, y = avg_moodswing, group = 1)) +
  geom_line(color = "purple", size = 1.5, alpha = 0.7) +
  geom_point(color = "purple", size = 3) +
  geom_text(aes(label = round(avg_moodswing, 2)), vjust = -1, size = 4, fontface = "bold") +
  labs(
    title = "Average Mood Swing Intensity Across Menstrual Cycle Phases",
    subtitle = "Higher values indicate more severe mood swings (Scale: 1-4)",
    x = "Phase",
    y = "Average Mood Swing Intensity"
  ) +
  ylim(0, 4) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = "bold"),
    panel.grid.major = element_line(color = "grey90")
  )

```

EDA: Average mood swing is highest in Menstrual phase (1.85), lowest in Luteal phase (1.41), with intermediate levels in Follicular and Fertility phases.

Discussion: Average Mood Swing Across Phases: menstrual has the highest luteal phase. 





Mood Swing & Fatigue Linear Mixed Models

Topic: Test whether mood swing and fatigue differ by menstrual phase, accounting for repeated measures.
```{r, echo=FALSE}
mood_mixed_model <- lmer(moodswing_score ~ phase + (1 | id), data = hormone_symptoms)
fatigue_mixed_model <- lmer(fatigue_score ~ phase + (1 | id), data = hormone_symptoms)


mood_mixed_model
fatigue_mixed_model
```

EDA: Mood swings are lowest near ovulation, slightly higher in Luteal, and peak during Menstrual phase. Fatigue shows a similar pattern: lowest near ovulation, increasing through Luteal, highest during Menstrual phase. Random effects indicate that some individuals are chronically more fatigued or mood-sensitive than others, while residual variance captures day-to-day variability.

Discussion: Linear mixed-effects models confirm phase-dependent changes. Menstrual phase shows the greatest increases in both mood swings and fatigue, consistent with estrogen and progesterone withdrawal. Substantial inter-individual variability underscores the importance of accounting for repeated measures.


###Flow Volume Distribution Across Phases

Topic: Visualize flow volume variation across phases with violin plots to assess distribution patterns. 
```{r, echo=FALSE}
#violin
ggplot(hormone_symptoms, aes(x = phase, y = flow_volume_score)) +
  geom_violin(fill = "skyblue", alpha = 0.5) +  
  labs(
    title = "Distribution of Flow Volume Across Phases",
    x = "Phase", y = "Flow Volume (0–6)"
  ) +
  theme_minimal()
```
EDA: Luteal phase shows a right-skewed distribution, indicating most low-flow observations but a few high-flow days. Menstrual phase is narrow and tall, indicating consistently higher flow intensity.

Discussion: Flow volume is biologically highest during menstruation due to active shedding of the endometrium. Luteal phase generally has minimal flow, reflecting the quiescent secretory phase.




Average Flow Volume and Appetite Across Phases

Topic: Summarize average flow volume and appetite to observe general trends across the menstrual cycle.
```{r, echo=FALSE}
cycle_avg <- hormone_symptoms |>
  group_by(phase) |>
  summarise(
    avg_flow_volume = mean(flow_volume_score, na.rm = TRUE),
    avg_appetite    = mean(appetite_score, na.rm = TRUE),
    .groups = "drop"
  )

# Flow Volume
ggplot(cycle_avg, aes(x = phase, y = avg_flow_volume, group = 1)) +
  geom_line(size = 1.2, color = "blue") +
  geom_point(size = 3, color = "red") +
  geom_text(aes(label = round(avg_flow_volume, 2)), vjust = -1, size = 4, fontface = "bold") +
  labs(title = "Average Flow Volume Across Phases",
       x = "Phase", y = "Flow Volume Score") +
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = "bold"),
    panel.grid.major = element_line(color = "grey90")
  )

```
EDA: Menstrual phase has the highest average flow (2.38), Luteal is lowest (0.03), Fertility is 0.07, and Follicular is 0.23.

Discussion: Average flow reflects physiological endometrial shedding. Menstruation peaks in intensity, Luteal remains minimal, matching known biological patterns.


```{r, echo=FALSE}
# Appetite
ggplot(cycle_avg, aes(x = phase, y = avg_appetite, group = 1)) +
  geom_line(size = 1.2, color = "purple") +
  geom_point(size = 3, color = "red") +
  geom_text(aes(label = round(avg_appetite, 2)), vjust = -1, size = 4, fontface = "bold") +
  labs(title = "Average Appetite Across Phases",
       x = "Phase", y = "Appetite Score") +
  theme_minimal()+
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = "bold"),
    panel.grid.major = element_line(color = "grey90")
  )
```

EDA: Appetite is highest in Fertility (2.96), lowest in Follicular (2.85), Luteal 2.95, Menstrual 2.90.

Discussion: Appetite appears modestly correlated with estrogen levels, peaking during Fertility when estrogen is highest. Other phases show smaller differences, suggesting hormonal influence is phase-specific but subtle.




###Linear Mixed Model: Appetite vs Estrogen
Topic: Explore the relationship between estrogen levels and appetite scores, accounting for repeated measures.
```{r, echo=FALSE}
appetite_model <- lmer(appetite_score ~ estrogen + (1 | id), data = hormone_symptoms)
summary(appetite_model)
```
EDA: Random intercept variance (0.1746) indicates participant-specific baseline appetite differences. The fixed effect of estrogen is small (0.00013 per unit) and not significant (t = 0.869).

Discussion: After accounting for repeated measures, there is no clear evidence that higher estrogen directly predicts higher appetite. Baseline individual differences explain more variance than hormonal fluctuations alone. Including phase or other hormones (LH, PDG) may improve model sensitivity.


limitation:

Several limitations should be considered when interpreting these findings. First, the dataset relies on self-reported symptom scores, which may be subject to recall bias or subjective interpretation. Second, while repeated measures are accounted for using linear mixed models, the sample size for some phases may be limited, reducing statistical power to detect subtle effects. Finally, other biological and lifestyle factors—such as stress, sleep, diet, and physical activity—were not controlled for, which could influence mood, appetite, and fatigue. Therefore, the results should be interpreted as suggestive of phase-related trends rather than definitive causal effects.
