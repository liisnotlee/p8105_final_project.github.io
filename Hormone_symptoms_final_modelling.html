<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>HORMONES &amp; SYMPTOMS: STATISTICAL MODELLING</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-solid fa-spa"></span>
     
  </a>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Exploratory Data Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Hormone_symtoms_final.html">Hormone &amp; Symptoms</a>
    </li>
    <li>
      <a href="sleep_stress_final.html">Sleep &amp; Stress</a>
    </li>
    <li>
      <a href="exercise_final.html">Exercise</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Statistical Modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Hormone_symptoms_final_modelling.html">Hormone &amp; Symptoms</a>
    </li>
    <li>
      <a href="sleep_stress_final_modelling.html">Sleep &amp; Stress</a>
    </li>
    <li>
      <a href="exercise_final_modelling.html">Exercise</a>
    </li>
    <li>
      <a href="multimodal_final_modelling.html">Multimodal Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="p8105_final_project_proposal.html">Proposal</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/liisnotlee/p8105_final_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">HORMONES &amp; SYMPTOMS: STATISTICAL
MODELLING</h1>

</div>


<div id="hormone-and-symptoms" class="section level1">
<h1>Hormone and Symptoms</h1>
<div id="mood-swing-linear-mixed-models" class="section level2">
<h2>Mood Swing Linear Mixed Models</h2>
<p>Test whether mood swing differ by menstrual phase, accounting for
repeated measures.</p>
<pre class="r"><code>mood_mixed_model &lt;- lmer(moodswing_score ~ phase + (1 | id), data = hormone_symptoms)


create_model_table &lt;- function(model, model_name) {
  # Get tidy output
  tidy_output &lt;- tidy(model, effects = &quot;fixed&quot;, conf.int = TRUE)
  
  # Extract p-values from model summary
  p_values &lt;- summary(model)$coefficients[, ncol(summary(model)$coefficients)]
  
  # Create the table
  table &lt;- tidy_output %&gt;%
    select(term, estimate, std.error, conf.low, conf.high) %&gt;%
    mutate(
      p.value = p_values[match(term, names(p_values))],
      significant = ifelse(p.value &lt; 0.05, &quot;Yes&quot;, &quot;No&quot;),
      model = model_name
    ) %&gt;%
    select(model, everything())
  
  return(table)
}
mood_table = create_model_table(mood_mixed_model, &quot;Mood Swing ~ Phase&quot;)|&gt;
  knitr::kable(digits = 3)
mood_table</code></pre>
<table>
<colgroup>
<col width="20%" />
<col width="17%" />
<col width="9%" />
<col width="10%" />
<col width="9%" />
<col width="10%" />
<col width="8%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="right">p.value</th>
<th align="left">significant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mood Swing ~ Phase</td>
<td align="left">(Intercept)</td>
<td align="right">1.428</td>
<td align="right">0.157</td>
<td align="right">1.112</td>
<td align="right">1.743</td>
<td align="right">0.000</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Mood Swing ~ Phase</td>
<td align="left">phasefollicular</td>
<td align="right">-0.024</td>
<td align="right">0.056</td>
<td align="right">-0.134</td>
<td align="right">0.085</td>
<td align="right">0.662</td>
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="left">Mood Swing ~ Phase</td>
<td align="left">phaseluteal</td>
<td align="right">0.104</td>
<td align="right">0.053</td>
<td align="right">0.001</td>
<td align="right">0.208</td>
<td align="right">0.047</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Mood Swing ~ Phase</td>
<td align="left">phasemenstrual</td>
<td align="right">0.345</td>
<td align="right">0.061</td>
<td align="right">0.224</td>
<td align="right">0.465</td>
<td align="right">0.000</td>
<td align="left">Yes</td>
</tr>
</tbody>
</table>
<p>Based on the model results, the average mood swing score during the
menstrual phase (the model intercept) is 1.77. Compared to this,
symptoms are modestly lower in other phases, with the follicular phase
showing the largest reduction of 0.37 points, followed by the fertility
window at 0.34 points lower, and the luteal phase at 0.24 points lower.
However, the analysis reveals that individual differences between
participants are substantial; the random effects standard deviation of
0.98 for participant baselines is nearly identical to the residual
standard deviation of 1.00, indicating that the unique baseline score of
an individual accounts for as much variance in the data as all other
unmeasured factors and the cycle phases combined. Therefore, while a
statistically significant pattern links the menstrual phase to higher
symptom reports, the predominant finding is the extensive variability
from person to person, underscoring that the experience of cycle-related
mood swings is highly individual.</p>
</div>
<div id="flow-volume-vs-lh" class="section level2">
<h2>Flow volume vs LH</h2>
<p>Observing in exploratory scatter plots that self-reported flow volume
scores appeared to follow an inverse pattern relative to luteinizing
hormone (LH) levels, I conducted a linear mixed model analysis to
formally test this visual hypothesis. The model was used to determine if
this apparent inverse relationship was statistically significant when
rigorously accounting for the repeated measures within each individual
participant.</p>
<pre class="r"><code>flow_volume_model &lt;- lmer(flow_volume_score ~ lh + (1 | id), data = hormone_symptoms)

flow_table &lt;- create_model_table(flow_volume_model, &quot;Flow Volume ~ LH&quot;)|&gt;
  knitr::kable(digits = 3)
flow_table</code></pre>
<table>
<colgroup>
<col width="19%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="9%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="right">p.value</th>
<th align="left">significant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Flow Volume ~ LH</td>
<td align="left">(Intercept)</td>
<td align="right">0.641</td>
<td align="right">0.077</td>
<td align="right">0.486</td>
<td align="right">0.797</td>
<td align="right">0.000</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Flow Volume ~ LH</td>
<td align="left">lh</td>
<td align="right">-0.011</td>
<td align="right">0.004</td>
<td align="right">-0.018</td>
<td align="right">-0.004</td>
<td align="right">0.001</td>
<td align="left">Yes</td>
</tr>
</tbody>
</table>
<p>Based on the linear mixed model, a significant but modest
relationship exists between luteinizing hormone (LH) levels and
perceived menstrual flow volume. For every one-unit increase in LH, the
flow volume score is estimated to decrease by -0.01138 points (p =
0.00129). While statistically significant, this effect is small in
magnitude. The model indicates substantial individual differences, as
the variation in scores within a single person over time (residual SD =
1.19) is much greater than the average differences between individuals’
baselines (intercept SD = 0.45). Therefore, while LH shows a significant
inverse association with flow volume, within-person biological and
measurement variability remains the dominant feature of the data.</p>
</div>
<div id="appetite-vs-estrogen" class="section level2">
<h2>Appetite vs Estrogen</h2>
<p>After observing in a scatter plot that average moodswing scores
appeared to follow estrogen patterns, I applied a linear mixed model to
appetite to formally test whether estrogen levels directly predict its
changes within individuals.</p>
<pre class="r"><code>appetite_model &lt;- lmer(appetite_score ~ estrogen + (1 | id), data = hormone_symptoms)
appetite_table &lt;- create_model_table(appetite_model, &quot;Appetite ~ Estrogen&quot;)|&gt;
  knitr::kable(digits = 3)
appetite_table</code></pre>
<table style="width:100%;">
<colgroup>
<col width="22%" />
<col width="13%" />
<col width="10%" />
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="8%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="right">p.value</th>
<th align="left">significant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Appetite ~ Estrogen</td>
<td align="left">(Intercept)</td>
<td align="right">2.894</td>
<td align="right">0.069</td>
<td align="right">2.754</td>
<td align="right">3.033</td>
<td align="right">0.000</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Appetite ~ Estrogen</td>
<td align="left">estrogen</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.000</td>
<td align="right">0.385</td>
<td align="left">No</td>
</tr>
</tbody>
</table>
<p>Based on the linear mixed-effects model, the analysis finds no
statistically significant relationship between measured estrogen levels
and self-reported appetite scores in this dataset. The model estimates
that for every one-unit increase in estrogen, the appetite score
increases by a mere 0.0001137 points, an effect size so small as to be
negligible. This relationship is not reliable, as indicated by a p-value
of 0.402, which is far above the conventional threshold for
significance. The model estimates the average appetite score when
estrogen is zero to be 2.897 points. More notably, the random effects
structure reveals that differences between individuals account for
meaningful variation; the standard deviation of individual baseline
scores is 0.415, while the standard deviation of the within-person
residuals is 0.726. This indicates that while people have different
typical appetite levels, the unexplained variation within a person’s own
measurements over time is nearly twice as large as the differences
between individuals, and estrogen, as modeled here, does not explain a
significant portion of that within-person fluctuation.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
