<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2025-11-17" />

<title>hormone</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-solid fa-spa"></span>
     
  </a>
</li>
<li class="dropdown-header">Data</li>
<li class="dropdown-header">Report</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lifestyle Factors Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="hormone.html">Hormone</a>
    </li>
    <li class="dropdown-header">Exercise</li>
    <li class="dropdown-header">Sleep &amp; Stress</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown-header">Meet the Team</li>
<li>
  <a>
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">hormone</h1>
<h4 class="date">2025-11-17</h4>

</div>


<p>##yue’s interest: phase, lh, estrogen, moodswing, fatigue</p>
<p>first, explore relationship between LH and estrogen</p>
<p>#estrogen surge at fertility(actually it should be called ovulation)
#lh also peak at ovulation</p>
<p>fatigue and moodswing</p>
<p>##this two bar graph show the proportion of fatigue and moodswing
among four phases, but they are hard to read.</p>
<p>#so i aim to change the catogorical value (low, moderate, high) to
1,2,3, and so on. i want to sum and avrage. to show a typical cahnge of
fatigue and mood in four phases.</p>
<pre class="r"><code># Convert moodswing and fatigue to numeric intensity scores
my_int_numeric &lt;- my_int_clean %&gt;%
  mutate(
    moodswing_num = case_when(
      moodswing == &quot;Very Low/Little&quot; ~ 1,
      moodswing == &quot;Low&quot; ~ 2,
      moodswing == &quot;Moderate&quot; ~ 3,
      moodswing == &quot;High&quot; ~ 4,
      moodswing == &quot;Very High&quot; ~ 5,
      TRUE ~ NA_real_
    ),
    fatigue_num = case_when(
      fatigue == &quot;Low&quot; ~ 1,
      fatigue == &quot;Moderate&quot; ~ 2,
      fatigue == &quot;High&quot; ~ 3,
      fatigue == &quot;Very High&quot; ~ 4,
      TRUE ~ NA_real_
    )
  )

# Calculate average intensity by phase
symptom_means &lt;- my_int_numeric %&gt;%
  group_by(phase = factor(phase, levels = phase_order)) %&gt;%
  summarise(
    avg_moodswing = mean(moodswing_num, na.rm = TRUE),
    avg_fatigue = mean(fatigue_num, na.rm = TRUE),
    n = n(),
    .groups = &#39;drop&#39;
  )

symptom_means</code></pre>
<pre><code>## # A tibble: 4 × 4
##   phase      avg_moodswing avg_fatigue     n
##   &lt;fct&gt;              &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;
## 1 Menstrual           2.57        2.32   482
## 2 Follicular          2.40        2.26   603
## 3 Fertility           2.42        2.25   507
## 4 Luteal              2.54        2.21   811</code></pre>
<pre class="r"><code># Mood swing single line plot
ggplot(symptom_means, aes(x = phase, y = avg_moodswing, group = 1)) +
  geom_line(color = &quot;purple&quot;, size = 1.5, alpha = 0.7) +
  geom_point(color = &quot;purple&quot;, size = 3) +
  geom_text(aes(label = round(avg_moodswing, 2)), vjust = -1, size = 4, fontface = &quot;bold&quot;) +
  labs(
    title = &quot;Average Mood Swing Intensity Across Menstrual Cycle Phases&quot;,
    subtitle = &quot;Higher values indicate more severe mood swings (Scale: 1-4)&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Average Mood Swing Intensity&quot;
  ) +
  ylim(1, 4) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = &quot;bold&quot;),
    panel.grid.major = element_line(color = &quot;grey90&quot;)
  )</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># Fatigue single line plot
ggplot(symptom_means, aes(x = phase, y = avg_fatigue, group = 1)) +
  geom_line(color = &quot;darkorange&quot;, size = 1.5, alpha = 0.7) +
  geom_point(color = &quot;darkorange&quot;, size = 3) +
  geom_text(aes(label = round(avg_fatigue, 2)), vjust = -1, size = 4, fontface = &quot;bold&quot;) +
  labs(
    title = &quot;Average Fatigue Intensity Across Menstrual Cycle Phases&quot;,
    subtitle = &quot;Higher values indicate more severe fatigue (Scale: 1-4)&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Average Fatigue Intensity&quot;
  ) +
  ylim(1, 4) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = &quot;bold&quot;),
    panel.grid.major = element_line(color = &quot;grey90&quot;)
  )</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div
id="for-the-test-i-want-to-test-if-moodswing-and-fatigue-have-statsitically-difference-between-those-four-phases."
class="section level2">
<h2>for the test, i want to test if moodswing and fatigue have
statsitically difference between those four phases.</h2>
<pre class="r"><code>kruskal.test(moodswing_num ~ phase, data = my_int_numeric)</code></pre>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  moodswing_num by phase
## Kruskal-Wallis chi-squared = 7.4651, df = 3, p-value = 0.05846</code></pre>
<pre class="r"><code>kruskal.test(fatigue_num ~ phase, data = my_int_numeric)</code></pre>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  fatigue_num by phase
## Kruskal-Wallis chi-squared = 4.3521, df = 3, p-value = 0.2259</code></pre>
<p>#cannot reject H0, There is no strong statistical evidence that
average instensity of moodswing or fatigue vary across menstrual phases
in this dataset.</p>
<p>#swich approach: longtidual changes</p>
<pre class="r"><code>#moodswing
ggplot(my_int_numeric, aes(x = phase, y = moodswing_num, group = id)) +
  geom_line(alpha = 0.3) +
  geom_point(alpha = 0.5) +
  labs(
    title = &quot;Individual Mood Swing Trajectories Across Phases&quot;,
    x = &quot;Phase&quot;,
    y = &quot;Mood Swing (1–5)&quot;
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<pre><code>## Warning: Removed 171 rows containing missing values or values outside the scale range
## (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 607 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>ggplot(my_int_numeric, aes(x = phase, y = fatigue_num, group = id)) +
  geom_line(alpha = 0.3) +
  geom_point(alpha = 0.5) +
  labs(
    title = &quot;Individual Fatigue Trajectories Across Phases&quot;,
    x = &quot;Phase&quot;,
    y = &quot;Fatigue (1–4)&quot;
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code>library(lme4)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre class="r"><code># Moodswing model
m1 &lt;- lmer(moodswing_num ~ phase + (1 | id), data = my_int_numeric)
summary(m1)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: moodswing_num ~ phase + (1 | id)
##    Data: my_int_numeric
## 
## REML criterion at convergence: 5001.4
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.5366 -0.7833 -0.0210  0.6304  3.3984 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  id       (Intercept) 0.4444   0.6667  
##  Residual             0.8841   0.9403  
## Number of obs: 1796, groups:  id, 41
## 
## Fixed effects:
##                 Estimate Std. Error t value
## (Intercept)    2.2030718  0.1170140  18.827
## phaseFertility 0.0006892  0.0671048   0.010
## phaseLuteal    0.1435950  0.0620028   2.316
## phaseMenstrual 0.2098644  0.0677096   3.099
## 
## Correlation of Fixed Effects:
##             (Intr) phsFrt phsLtl
## phaseFrtlty -0.267              
## phaseLuteal -0.301  0.521       
## phaseMnstrl -0.281  0.471  0.529</code></pre>
<pre class="r"><code># Fatigue model
m2 &lt;- lmer(fatigue_num ~ phase + (1 | id), data = my_int_numeric)
summary(m2)</code></pre>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: fatigue_num ~ phase + (1 | id)
##    Data: my_int_numeric
## 
## REML criterion at convergence: 5792.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.2593 -0.7365 -0.0118  0.6407  3.2156 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  id       (Intercept) 0.2544   0.5043  
##  Residual             0.6151   0.7843  
## Number of obs: 2403, groups:  id, 42
## 
## Fixed effects:
##                Estimate Std. Error t value
## (Intercept)     2.18666    0.08520  25.665
## phaseFertility  0.01517    0.04794   0.316
## phaseLuteal    -0.01330    0.04347  -0.306
## phaseMenstrual  0.09823    0.04951   1.984
## 
## Correlation of Fixed Effects:
##             (Intr) phsFrt phsLtl
## phaseFrtlty -0.257              
## phaseLuteal -0.292  0.519       
## phaseMnstrl -0.264  0.455  0.509</code></pre>
<p>#Individuals differ substantially in their baseline moodswing levels.
#Again, individuals differ in fatigue baseline, but not as widely as
moodswing.</p>
<p>###After adjusting for each individual’s baseline, moodswing
intensity significantly increases in the Luteal and Menstrual phases
compared with the Follicular phase. Fatigue slightly increases during
the Menstrual phase, but the effect is small and borderline
significant.</p>
<p>##Linear mixed-effects models were used to evaluate within-person
changes in moodswing and fatigue across menstrual phases. The models
included a random intercept for each participant to account for
individual baseline differences. For moodswing, both the Luteal phase (β
= 0.144) and the Menstrual phase (β = 0.210) showed significant
increases compared with the Follicular phase, indicating that moodswing
intensity tends to rise at these points in the cycle. Fertility showed
no difference. For fatigue, only the Menstrual phase showed a borderline
increase (β = 0.098), while Fertility and Luteal phases did not differ
from Follicular. These findings suggest that while group-level averages
obscure differences, within individuals, moodswing increases
meaningfully in the late luteal and menstrual stages, and fatigue rises
slightly during menstruation.</p>
<p>##some updates (Li’s advice) 1 scatter plot btw hormone and symtoms.
(it’s super ugly, no typical trend. everyone has their baseline,
#subjective self-report)</p>
<ol start="2" style="list-style-type: decimal">
<li>include more variable such as “flow color” or “flow volume”: most of
the data is “NOT AT ALL” and na.</li>
</ol>
<pre class="r"><code>sum(hormone$flow_volume == &quot;Not at all&quot;, na.rm = TRUE)</code></pre>
<pre><code>## [1] 2462</code></pre>
<pre class="r"><code>sum(hormone$flow_color == &quot;Not at all&quot;, na.rm = TRUE)</code></pre>
<pre><code>## [1] 2378</code></pre>
<pre class="r"><code>hormone|&gt;
  summarize(
    na_flow_volume = sum(is.na(flow_volume)),
    na_flow_color  = sum(is.na(flow_color))
  )</code></pre>
<pre><code>## # A tibble: 1 × 2
##   na_flow_volume na_flow_color
##            &lt;int&gt;         &lt;int&gt;
## 1           2470          2465</code></pre>
<pre class="r"><code>nrow(hormone)</code></pre>
<pre><code>## [1] 5659</code></pre>
<p>stress and sleepissue</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
