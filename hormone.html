<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>hormone</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-solid fa-spa"></span>
     
  </a>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lifestyle Factors Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="hormone.html">Hormone &amp; Symptoms</a>
    </li>
    <li>
      <a href="sleep_stress_khue.html">Sleep &amp; Stress</a>
    </li>
    <li>
      <a href="exercise_hormone.html">Exercise</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">Meet the Team</a>
</li>
<li>
  <a>
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">hormone</h1>

</div>


<p>##yue’s interest: phase, lh, estrogen, moodswing, fatigue</p>
<p>first, explore relationship between LH and estrogen</p>
<pre class="r"><code>my_int_avg= 
  my_int|&gt;
  group_by(phase)|&gt;
  summarise(
    estrogen_mean = mean(estrogen, na.rm = TRUE),
    lh_mean = mean(lh, na.rm = TRUE)
  )|&gt;
  mutate(phase = factor(phase, levels = phase_order))|&gt;
  filter(!is.na(phase))

# Plot the summarized data
ggplot(my_int_avg, aes(x = phase)) +
  geom_line(aes(y = estrogen_mean, color = &quot;Estrogen&quot;, group = 1), size = 1) +
  geom_line(aes(y = lh_mean, color = &quot;LH&quot;, group = 1), size = 1) +
  geom_point(aes(y = estrogen_mean, color = &quot;Estrogen&quot;), size = 3) +
  geom_point(aes(y = lh_mean, color = &quot;LH&quot;),size= 3) +
  labs(
    title = &quot;Average Estrogen and LH Levels Across Menstrual Cycle Phases&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Hormone Level&quot;,
    color = &quot;Hormone&quot;
  ) +
  scale_color_manual(values = c(&quot;Estrogen&quot; = &quot;red&quot;, &quot;LH&quot; = &quot;blue&quot;)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-4-1.png" width="672" />
#estrogen surge at fertility(actually it should be called ovulation) #lh
also peak at ovulation</p>
<p>fatigue and moodswing</p>
<p>##this two bar graph show the proportion of fatigue and moodswing
among four phases, but they are hard to read.</p>
<p>#so i aim to change the catogorical value (low, moderate, high) to
1,2,3, and so on. i want to sum and avrage. to show a typical cahnge of
fatigue and mood in four phases.</p>
<pre class="r"><code># Convert moodswing and fatigue to numeric intensity scores
my_int_numeric &lt;- my_int_clean %&gt;%
  mutate(
    moodswing_num = case_when(
      moodswing == &quot;Not at all&quot; ~0,
      moodswing == &quot;Very Low/Little&quot; ~ 1,
      moodswing == &quot;Low&quot; ~ 2,
      moodswing == &quot;Moderate&quot; ~ 3,
      moodswing == &quot;High&quot; ~ 4,
      moodswing == &quot;Very High&quot; ~ 5,
      TRUE ~ NA_real_
    ),
    fatigue_num = case_when(
      fatigue == &quot;Not at all&quot; ~0,
      fatigue == &quot;Low&quot; ~ 1,
      fatigue == &quot;Moderate&quot; ~ 2,
      fatigue == &quot;High&quot; ~ 3,
      fatigue == &quot;Very High&quot; ~ 4,
      TRUE ~ NA_real_
    )
  )

# Calculate average intensity by phase
symptom_means &lt;- my_int_numeric %&gt;%
  group_by(phase = factor(phase, levels = phase_order)) %&gt;%
  summarise(
    avg_moodswing = mean(moodswing_num, na.rm = TRUE),
    avg_fatigue = mean(fatigue_num, na.rm = TRUE),
    n = n(),
    .groups = &#39;drop&#39;
  )

symptom_means</code></pre>
<pre><code>## # A tibble: 4 × 4
##   phase      avg_moodswing avg_fatigue     n
##   &lt;fct&gt;              &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;
## 1 Menstrual           1.96        2.10   533
## 2 Follicular          1.53        1.90   719
## 3 Fertility           1.52        1.81   629
## 4 Luteal              1.56        1.86   965</code></pre>
<p>#overall scatterplot (can be deleted)</p>
<pre class="r"><code>ggplot(my_int_numeric, aes(x = phase, y = fatigue_num)) +
  geom_jitter(width = 0.2, alpha = 0.4, size = 1.5) +
  stat_summary(fun = mean, geom = &quot;point&quot;, color = &quot;red&quot;, size = 4) +
  labs(
    title = &quot;Fatigue Intensity Across Menstrual Cycle Phases&quot;,
    x = &quot;Phase&quot;,
    y = &quot;Fatigue (0–4 scale)&quot;
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>ggplot(my_int_numeric, aes(x = phase, y = moodswing_num)) +
  geom_jitter(width = 0.2, alpha = 0.4, size = 1.5) +
  stat_summary(fun = mean, geom = &quot;point&quot;, color = &quot;blue&quot;, size = 4) +
  labs(
    title = &quot;Mood Swing Intensity Across Menstrual Cycle Phases&quot;,
    x = &quot;Phase&quot;,
    y = &quot;Mood Swing (0–5 scale)&quot;
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># Mood swing single line plot
ggplot(symptom_means, aes(x = phase, y = avg_moodswing, group = 1)) +
  geom_line(color = &quot;purple&quot;, size = 1.5, alpha = 0.7) +
  geom_point(color = &quot;purple&quot;, size = 3) +
  geom_text(aes(label = round(avg_moodswing, 2)), vjust = -1, size = 4, fontface = &quot;bold&quot;) +
  labs(
    title = &quot;Average Mood Swing Intensity Across Menstrual Cycle Phases&quot;,
    subtitle = &quot;Higher values indicate more severe mood swings (Scale: 1-4)&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Average Mood Swing Intensity&quot;
  ) +
  ylim(1, 4) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = &quot;bold&quot;),
    panel.grid.major = element_line(color = &quot;grey90&quot;)
  )</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code># Fatigue single line plot
ggplot(symptom_means, aes(x = phase, y = avg_fatigue, group = 1)) +
  geom_line(color = &quot;darkorange&quot;, size = 1.5, alpha = 0.7) +
  geom_point(color = &quot;darkorange&quot;, size = 3) +
  geom_text(aes(label = round(avg_fatigue, 2)), vjust = -1, size = 4, fontface = &quot;bold&quot;) +
  labs(
    title = &quot;Average Fatigue Intensity Across Menstrual Cycle Phases&quot;,
    subtitle = &quot;Higher values indicate more severe fatigue (Scale: 1-4)&quot;,
    x = &quot;Menstrual Cycle Phase&quot;,
    y = &quot;Average Fatigue Intensity&quot;
  ) +
  ylim(1, 4) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    plot.title = element_text(face = &quot;bold&quot;),
    panel.grid.major = element_line(color = &quot;grey90&quot;)
  )</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div
id="for-the-test-i-want-to-test-if-moodswing-and-fatigue-have-statsitically-difference-between-those-four-phases."
class="section level2">
<h2>for the test, i want to test if moodswing and fatigue have
statsitically difference between those four phases.</h2>
<pre class="r"><code>kruskal.test(moodswing_num ~ phase, data = my_int_numeric)</code></pre>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  moodswing_num by phase
## Kruskal-Wallis chi-squared = 36.244, df = 3, p-value = 6.648e-08</code></pre>
<pre class="r"><code>kruskal.test(fatigue_num ~ phase, data = my_int_numeric)</code></pre>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  fatigue_num by phase
## Kruskal-Wallis chi-squared = 18.896, df = 3, p-value = 0.0002873</code></pre>
<p>#Mood swing intensity differs significantly across menstrual
phases.</p>
<p>#Fatigue intensity also differs significantly across phases.</p>
<p>#swich approach: longtidual changes</p>
<pre class="r"><code>library(lme4)


# Moodswing model
m1 &lt;- lmer(moodswing_num ~ phase + (1 | id), data = my_int_numeric)
summary(m1)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: moodswing_num ~ phase + (1 | id)
##    Data: my_int_numeric
## 
## REML criterion at convergence: 8506.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0689 -0.5616 -0.1457  0.4561  4.1382 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  id       (Intercept) 1.051    1.025   
##  Residual             1.091    1.044   
## Number of obs: 2846, groups:  id, 42
## 
## Fixed effects:
##                  Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)     1.464e+00  1.633e-01  4.512e+01   8.967 1.38e-11 ***
## phaseFertility -2.881e-03  5.783e-02  2.805e+03  -0.050   0.9603    
## phaseLuteal     1.319e-01  5.299e-02  2.807e+03   2.489   0.0129 *  
## phaseMenstrual  3.584e-01  6.118e-02  2.806e+03   5.858 5.24e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) phsFrt phsLtl
## phaseFrtlty -0.166              
## phaseLuteal -0.184  0.525       
## phaseMnstrl -0.159  0.457  0.506</code></pre>
<pre class="r"><code># Fatigue model
m2 &lt;- lmer(fatigue_num ~ phase + (1 | id), data = my_int_numeric)
summary(m2)</code></pre>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: fatigue_num ~ phase + (1 | id)
##    Data: my_int_numeric
## 
## REML criterion at convergence: 7930.3
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.1591 -0.6811 -0.0214  0.5734  3.6953 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  id       (Intercept) 0.4885   0.6989  
##  Residual             0.8978   0.9475  
## Number of obs: 2846, groups:  id, 42
## 
## Fixed effects:
##                  Estimate Std. Error         df t value Pr(&gt;|t|)    
## (Intercept)     1.803e+00  1.140e-01  4.746e+01  15.817  &lt; 2e-16 ***
## phaseFertility -3.221e-03  5.246e-02  2.806e+03  -0.061    0.951    
## phaseLuteal     6.817e-02  4.806e-02  2.811e+03   1.418    0.156    
## phaseMenstrual  2.740e-01  5.549e-02  2.809e+03   4.937 8.39e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) phsFrt phsLtl
## phaseFrtlty -0.216              
## phaseLuteal -0.239  0.525       
## phaseMnstrl -0.206  0.457  0.506</code></pre>
<p>#for moodswing: Luteal phase: +0.13 (t = 2.49) Menstrual phase: +0.36
(t = 5.86) After accounting for repeated measures within individuals,
mood swings are significantly higher in the Luteal and Menstrual phases
compared to the Follicular phase.</p>
<p>#for fatigue: Menstrual phase: +0.27 (t = 4.94) Luteal (+0.07) and
Fertility (~0) phases not significant. only the Menstrual phase shows
significantly higher fatigue compared to the Follicular phase.</p>
<p>reletionship between hormone and flow color, flor volume, and
appetite</p>
<pre class="r"><code>my_i = 
  hormone |&gt;
  select(id, phase, lh, estrogen, flow_color, flow_volume, appetite) |&gt;
  mutate(
    phase = factor(phase, levels = c(&quot;Follicular&quot;, &quot;Fertility&quot;, &quot;Luteal&quot;, &quot;Menstrual&quot;)),
    flow_volume = factor(flow_volume, 
                         levels = c(&quot;Not at all&quot;, &quot;Spotting / Very Light&quot;,&quot;Light&quot;,&quot;Moderate&quot;,
                                     &quot;Somewhat Heavy&quot;,&quot;Heavy&quot;, &quot;Very Heavy&quot;)),
    flow_color = factor(flow_color,
                        levels = c(&quot;Not at all&quot;, &quot;Pink&quot;,&quot;Bright Red&quot;, &quot;Dark Brown / Dark Red&quot;, &quot;Grey&quot;, 
                                    &quot;Black&quot;,&quot;Other&quot;)),
    appetite = factor(appetite,
                      levels = c(&quot;Very Low&quot;,&quot;Low&quot;,  &quot;Moderate&quot;, &quot;High&quot;, &quot;Very High&quot;))
  )   

phase_order = c(&quot;Menstrual&quot;, &quot;Follicular&quot;, &quot;Fertility&quot;, &quot;Luteal&quot;)
colSums(is.na(my_i[, c(&quot;flow_volume&quot;, &quot;flow_color&quot;, &quot;appetite&quot;)]))</code></pre>
<pre><code>## flow_volume  flow_color    appetite 
##        2567        2617        2333</code></pre>
<pre class="r"><code># Flow volume frequencies by phase
table_flow_vol &lt;- my_i %&gt;%
  filter(!is.na(flow_volume)) %&gt;%
  count(phase, flow_volume) %&gt;%
  group_by(phase) %&gt;%
  mutate(pct = n / sum(n) * 100) %&gt;%
  arrange(phase)
table_flow_vol</code></pre>
<pre><code>## # A tibble: 25 × 4
## # Groups:   phase [5]
##    phase      flow_volume               n    pct
##    &lt;fct&gt;      &lt;fct&gt;                 &lt;int&gt;  &lt;dbl&gt;
##  1 Follicular Not at all              652 80.8  
##  2 Follicular Spotting / Very Light    99 12.3  
##  3 Follicular Light                    39  4.83 
##  4 Follicular Moderate                 14  1.73 
##  5 Follicular Somewhat Heavy            3  0.372
##  6 Fertility  Not at all              666 94.9  
##  7 Fertility  Spotting / Very Light    21  2.99 
##  8 Fertility  Light                     6  0.855
##  9 Fertility  Moderate                  7  0.997
## 10 Fertility  Somewhat Heavy            1  0.142
## # ℹ 15 more rows</code></pre>
<pre class="r"><code># Flow color
table_flow_color &lt;- my_i %&gt;%
  filter(!is.na(flow_color)) %&gt;%
  count(phase, flow_color) %&gt;%
  group_by(phase) %&gt;%
  mutate(pct = n / sum(n) * 100)
table_flow_color</code></pre>
<pre><code>## # A tibble: 24 × 4
## # Groups:   phase [5]
##    phase      flow_color                n    pct
##    &lt;fct&gt;      &lt;fct&gt;                 &lt;int&gt;  &lt;dbl&gt;
##  1 Follicular Not at all              639 82.2  
##  2 Follicular Pink                      7  0.901
##  3 Follicular Bright Red               23  2.96 
##  4 Follicular Dark Brown / Dark Red    81 10.4  
##  5 Follicular Grey                      4  0.515
##  6 Follicular Black                     4  0.515
##  7 Follicular Other                    19  2.45 
##  8 Fertility  Not at all              639 94.8  
##  9 Fertility  Bright Red                1  0.148
## 10 Fertility  Dark Brown / Dark Red     3  0.445
## # ℹ 14 more rows</code></pre>
<pre class="r"><code># Appetite
table_appetite &lt;- my_i %&gt;%
  filter(!is.na(appetite)) %&gt;%
  count(phase, appetite) %&gt;%
  group_by(phase) %&gt;%
  mutate(pct = n / sum(n) * 100)
table_appetite</code></pre>
<pre><code>## # A tibble: 21 × 4
## # Groups:   phase [5]
##    phase      appetite      n   pct
##    &lt;fct&gt;      &lt;fct&gt;     &lt;int&gt; &lt;dbl&gt;
##  1 Follicular Very Low     55  6.55
##  2 Follicular Low         193 23.0 
##  3 Follicular Moderate    438 52.1 
##  4 Follicular High        140 16.7 
##  5 Follicular Very High    14  1.67
##  6 Fertility  Very Low     37  5.05
##  7 Fertility  Low         156 21.3 
##  8 Fertility  Moderate    384 52.5 
##  9 Fertility  High        132 18.0 
## 10 Fertility  Very High    23  3.14
## # ℹ 11 more rows</code></pre>
<p>Overall scatter plot for three variables:</p>
<pre class="r"><code>my_i_plot &lt;- my_i %&gt;%
  filter(!is.na(phase) &amp; (!is.na(flow_volume) | !is.na(flow_color) | !is.na(appetite)))

# Optional: convert ordered factors to numeric for plotting
my_i_plot &lt;- my_i_plot %&gt;%
  mutate(
    flow_volume_num = as.numeric(flow_volume),
    flow_color_num  = as.numeric(flow_color),
    appetite_num    = as.numeric(appetite)
  )

# 1) FLOW VOLUME
ggplot(my_i_plot, aes(x = phase, y = flow_volume_num)) +
  geom_jitter(width = 0.2, height = 0, alpha = 0.4, color = &quot;blue&quot;) +
  stat_summary(fun = mean, geom = &quot;point&quot;, size = 3, color = &quot;red&quot;) +
  stat_summary(fun = mean, geom = &quot;line&quot;, aes(group = 1), color = &quot;red&quot;, size = 1) +
  scale_y_continuous(
    breaks = 1:length(levels(my_i$flow_volume)),
    labels = levels(my_i$flow_volume)
  ) +
  labs(title = &quot;Flow Volume Across Menstrual Cycle Phases&quot;,
       y = &quot;Flow Volume&quot;,
       x = &quot;Phase&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<pre><code>## Warning: Removed 460 rows containing non-finite outside the scale
## range (`stat_summary()`).
## Removed 460 rows containing non-finite outside the scale
## range (`stat_summary()`).</code></pre>
<pre><code>## Warning: Removed 460 rows containing missing values or values
## outside the scale range (`geom_point()`).</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code># 2) FLOW COLOR
ggplot(my_i_plot, aes(x = phase, y = flow_color_num)) +
  geom_jitter(width = 0.2, height = 0, alpha = 0.4, color = &quot;darkgreen&quot;) +
  stat_summary(fun = mean, geom = &quot;point&quot;, size = 3, color = &quot;red&quot;) +
  stat_summary(fun = mean, geom = &quot;line&quot;, aes(group = 1), color = &quot;red&quot;, size = 1) +
  scale_y_continuous(
    breaks = 1:length(levels(my_i$flow_color)),
    labels = levels(my_i$flow_color)
  ) +
  labs(title = &quot;Flow Color Across Menstrual Cycle Phases&quot;,
       y = &quot;Flow Color&quot;,
       x = &quot;Phase&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<pre><code>## Warning: Removed 510 rows containing non-finite outside the scale
## range (`stat_summary()`).</code></pre>
<pre><code>## Warning: Removed 510 rows containing non-finite outside the scale
## range (`stat_summary()`).</code></pre>
<pre><code>## Warning: Removed 510 rows containing missing values or values
## outside the scale range (`geom_point()`).</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r"><code># 3) APPETITE
ggplot(my_i_plot, aes(x = phase, y = appetite_num)) +
  geom_jitter(width = 0.2, height = 0, alpha = 0.4, color = &quot;purple&quot;) +
  stat_summary(fun = mean, geom = &quot;point&quot;, size = 3, color = &quot;red&quot;) +
  stat_summary(fun = mean, geom = &quot;line&quot;, aes(group = 1), color = &quot;red&quot;, size = 1) +
  scale_y_continuous(
    breaks = 1:length(levels(my_i$appetite)),
    labels = levels(my_i$appetite)
  ) +
  labs(title = &quot;Appetite Across Menstrual Cycle Phases&quot;,
       y = &quot;Appetite&quot;,
       x = &quot;Phase&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<pre><code>## Warning: Removed 226 rows containing non-finite outside the scale
## range (`stat_summary()`).</code></pre>
<pre><code>## Warning: Removed 226 rows containing non-finite outside the scale
## range (`stat_summary()`).</code></pre>
<pre><code>## Warning: Removed 226 rows containing missing values or values
## outside the scale range (`geom_point()`).</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
<pre class="r"><code>#give them order to do the avereage graph
my_i_num &lt;- my_i %&gt;%
  filter(!is.na(phase)) %&gt;%
  mutate(
    # Flow volume: example mapping
    flow_volume_num = case_when(
      flow_volume == &quot;Not at all&quot; ~ 0,
      flow_volume == &quot;Spotting / Very Light&quot; ~ 1,
      flow_volume == &quot;Light&quot; ~ 2,
      flow_volume == &quot;Moderate&quot; ~ 3,
      flow_volume == &quot;Somewhat Heavy&quot; ~ 4,
      flow_volume == &quot;Heavy&quot; ~ 5,
      flow_volume == &quot;Very Heavy&quot; ~ 6,
      TRUE ~ NA_real_
    ),
    # Flow color: example mapping
    flow_color_num = case_when(
      flow_color == &quot;Not at all&quot; ~ 0,
      flow_color == &quot;Pink&quot; ~ 1,
      flow_color == &quot;Bright Red&quot; ~ 2,
      flow_color == &quot;Dark Brown / Dark Red&quot; ~ 3,
      flow_color == &quot;Grey&quot; ~ 4,
      flow_color == &quot;Black&quot; ~ 5,
      flow_color == &quot;Other&quot; ~ 6,
      TRUE ~ NA_real_
    ),
    # Appetite: example mapping
    appetite_num = case_when(
      appetite == &quot;Very Low&quot; ~ 0,
      appetite == &quot;Low&quot; ~ 1,
      appetite == &quot;Moderate&quot; ~ 2,
      appetite == &quot;High&quot; ~ 3,
      appetite == &quot;Very High&quot; ~ 4,
      TRUE ~ NA_real_
    )
  )</code></pre>
<pre class="r"><code>#graphing
phase_order &lt;- c(&quot;Menstrual&quot;, &quot;Follicular&quot;, &quot;Fertility&quot;, &quot;Luteal&quot;)

my_i_avg &lt;- my_i_num %&gt;%
  group_by(phase = factor(phase, levels = phase_order)) %&gt;%
  summarise(
    avg_flow_volume = mean(flow_volume_num, na.rm = TRUE),
    avg_flow_color  = mean(flow_color_num, na.rm = TRUE),
    avg_appetite    = mean(appetite_num, na.rm = TRUE),
    .groups = &#39;drop&#39;
  )

flow_volume_levels &lt;- c(&quot;Not at all&quot;, &quot;Spotting / Very Light&quot;, &quot;Light&quot;, &quot;Moderate&quot;,
                        &quot;Somewhat Heavy&quot;, &quot;Heavy&quot;, &quot;Very Heavy&quot;)

ggplot(my_i_avg, aes(x = phase, y = avg_flow_volume, group = 1)) +
  geom_line(color = &quot;blue&quot;, size = 1.5) +
  geom_point(color = &quot;red&quot;, size = 3) +
  geom_text(aes(label = round(avg_flow_volume,2)), vjust = -0.5) +
  scale_y_continuous(limits = c(0,6), breaks = 0:6, labels = flow_volume_levels) +
  labs(title = &quot;Average Flow Volume Across Menstrual Cycle Phases&quot;,
       x = &quot;Phase&quot;, y = &quot;Flow Volume&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code># Flow color
flow_color_levels &lt;- c(&quot;Not at all&quot;, &quot;Pink&quot;, &quot;Bright Red&quot;, &quot;Dark Brown / Dark Red&quot;,
                       &quot;Grey&quot;, &quot;Black&quot;, &quot;Other&quot;)

ggplot(my_i_avg, aes(x = phase, y = avg_flow_color, group = 1)) +
  geom_line(color = &quot;darkgreen&quot;, size = 1.5) +
  geom_point(color = &quot;red&quot;, size = 3) +
  geom_text(aes(label = round(avg_flow_color,2)), vjust = -0.5) +
  scale_y_continuous(limits = c(0,6), breaks = 0:6, labels = flow_color_levels) +
  labs(title = &quot;Average Flow Color Across Menstrual Cycle Phases&quot;,
       x = &quot;Phase&quot;, y = &quot;Flow Color&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<pre class="r"><code># Appetite
appetite_levels &lt;- c(&quot;Very Low&quot;, &quot;Low&quot;, &quot;Moderate&quot;, &quot;High&quot;, &quot;Very High&quot;)

ggplot(my_i_avg, aes(x = phase, y = avg_appetite, group = 1)) +
  geom_line(color = &quot;purple&quot;, size = 1.5) +
  geom_point(color = &quot;red&quot;, size = 3) +
  geom_text(aes(label = round(avg_appetite,2)), vjust = -0.5) +
  scale_y_continuous(limits = c(0,4), breaks = 0:4, labels = appetite_levels) +
  labs(title = &quot;Average Appetite Across Menstrual Cycle Phases&quot;,
       x = &quot;Phase&quot;, y = &quot;Appetite&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-17-3.png" width="672" /></p>
<p>#the not at all strongly affect the curve. so i tried another scatter
plot for each (delete the not at all)</p>
<pre class="r"><code>my_i_filtered &lt;- my_i %&gt;%
  filter(flow_volume != &quot;Not at all&quot;, flow_color != &quot;Not at all&quot;) %&gt;%
  mutate(
    # Flow volume numeric mapping
    flow_volume_num = case_when(
      flow_volume == &quot;Spotting / Very Light&quot; ~ 1,
      flow_volume == &quot;Light&quot; ~ 2,
      flow_volume == &quot;Moderate&quot; ~ 3,
      flow_volume == &quot;Somewhat Heavy&quot; ~ 4,
      flow_volume == &quot;Heavy&quot; ~ 5,
      flow_volume == &quot;Very Heavy&quot; ~ 6,
      TRUE ~ NA_real_
    ),
    # Flow color numeric mapping
    flow_color_num = case_when(
      flow_color == &quot;Pink&quot; ~ 1,
      flow_color == &quot;Bright Red&quot; ~ 2,
      flow_color == &quot;Dark Brown / Dark Red&quot; ~ 3,
      flow_color == &quot;Grey&quot; ~ 4,
      flow_color == &quot;Black&quot; ~ 5,
      flow_color == &quot;Other&quot; ~ 6,
      TRUE ~ NA_real_
    )
  )
phase_order &lt;- c(&quot;Menstrual&quot;, &quot;Follicular&quot;, &quot;Fertility&quot;, &quot;Luteal&quot;)

avg_flow &lt;- my_i_filtered %&gt;%
  group_by(phase = factor(phase, levels = phase_order)) %&gt;%
  summarise(
    avg_flow_volume = mean(flow_volume_num, na.rm = TRUE),
    avg_flow_color = mean(flow_color_num, na.rm = TRUE),
    .groups = &#39;drop&#39;
  )
flow_volume_levels &lt;- c(&quot;Spotting / Very Light&quot;, &quot;Light&quot;, &quot;Moderate&quot;, 
                        &quot;Somewhat Heavy&quot;, &quot;Heavy&quot;, &quot;Very Heavy&quot;)

ggplot(avg_flow, aes(x = phase, y = avg_flow_volume, group = 1)) +
  geom_line(color = &quot;blue&quot;, size = 1.5) +
  geom_point(color = &quot;red&quot;, size = 3) +
  geom_text(aes(label = round(avg_flow_volume,2)), vjust = -0.5) +
  scale_y_continuous(limits = c(1,6), breaks = 1:6, labels = flow_volume_levels) +
  labs(title = &quot;Average Flow Volume Across Menstrual Cycle Phases (excluding &#39;Not at all&#39;)&quot;,
       x = &quot;Phase&quot;, y = &quot;Flow Volume&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code># Flow Color
flow_color_levels &lt;- c(&quot;Pink&quot;, &quot;Bright Red&quot;, &quot;Dark Brown / Dark Red&quot;, &quot;Grey&quot;,
                       &quot;Black&quot;, &quot;Other&quot;)

ggplot(avg_flow, aes(x = phase, y = avg_flow_color, group = 1)) +
  geom_line(color = &quot;darkgreen&quot;, size = 1.5) +
  geom_point(color = &quot;red&quot;, size = 3) +
  geom_text(aes(label = round(avg_flow_color,2)), vjust = -0.5) +
  scale_y_continuous(limits = c(1,6), breaks = 1:6, labels = flow_color_levels) +
  labs(title = &quot;Average Flow Color Across Menstrual Cycle Phases (excluding &#39;Not at all&#39;)&quot;,
       x = &quot;Phase&quot;, y = &quot;Flow Color&quot;) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="hormone_files/figure-html/unnamed-chunk-18-2.png" width="672" /></p>
<pre class="r"><code>#(with the not at all data)
library(dplyr)
library(tidyr)

# FLOW VOLUME
fv_df &lt;- my_i_num %&gt;%
  filter(!is.na(flow_volume_num)) %&gt;%
  group_by(id, phase) %&gt;%
  summarise(flow_volume_num = mean(flow_volume_num, na.rm = TRUE), .groups = &#39;drop&#39;) %&gt;%
  pivot_wider(names_from = phase, values_from = flow_volume_num) %&gt;%
  drop_na()

friedman.test(as.matrix(fv_df[,-1]))  # exclude id column</code></pre>
<pre><code>## 
##  Friedman rank sum test
## 
## data:  as.matrix(fv_df[, -1])
## Friedman chi-squared = 105.42, df = 3, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code># FLOW COLOR
fc_df &lt;- my_i_num %&gt;%
  filter(!is.na(flow_color_num)) %&gt;%
  group_by(id, phase) %&gt;%
  summarise(flow_color_num = mean(flow_color_num, na.rm = TRUE), .groups = &#39;drop&#39;) %&gt;%
  pivot_wider(names_from = phase, values_from = flow_color_num) %&gt;%
  drop_na()

friedman.test(as.matrix(fc_df[,-1]))</code></pre>
<pre><code>## 
##  Friedman rank sum test
## 
## data:  as.matrix(fc_df[, -1])
## Friedman chi-squared = 98.208, df = 3, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code># APPETITE
app_df &lt;- my_i_num %&gt;%
  filter(!is.na(appetite_num)) %&gt;%
  group_by(id, phase) %&gt;%
  summarise(appetite_num = mean(appetite_num, na.rm = TRUE), .groups = &#39;drop&#39;) %&gt;%
  pivot_wider(names_from = phase, values_from = appetite_num) %&gt;%
  drop_na()

friedman.test(as.matrix(app_df[,-1]))</code></pre>
<pre><code>## 
##  Friedman rank sum test
## 
## data:  as.matrix(app_df[, -1])
## Friedman chi-squared = 7.449, df = 3, p-value = 0.05888</code></pre>
<p>#Flow volume &amp; flow color: There are clear differences across
menstrual cycle phases. Likely patterns: heavier flow and darker color
in the Menstrual phase, lighter/spotting in Follicular/Luteal.</p>
<p>#Appetite:Overall differences across phases are not statistically
significant at α = 0.05. There may be a trend, but the variation is
smaller or more individual-specific.</p>
<p>To account for within-subject repeated measures and get
phase-specific effects, we can fit CLMM models:</p>
<pre class="r"><code>library(ordinal)

# Flow Volume
clmm_flowvol &lt;- clmm(flow_volume ~ phase + (1 | id), data = my_i, Hess = TRUE)
summary(clmm_flowvol)</code></pre>
<pre><code>## Cumulative Link Mixed Model fitted with the Laplace approximation
## 
## formula: flow_volume ~ phase + (1 | id)
## data:    my_i
## 
##  link  threshold nobs logLik   AIC     niter     max.grad cond.H 
##  logit flexible  3091 -1801.42 3622.83 824(3300) 2.08e-03 1.6e+02
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  id     (Intercept) 0.8281   0.91    
## Number of groups:  id 42 
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## phaseFertility  -1.5928     0.2016   -7.90 2.79e-15 ***
## phaseLuteal     -2.1400     0.2072  -10.33  &lt; 2e-16 ***
## phaseMenstrual   3.1333     0.1423   22.02  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Threshold coefficients:
##                                  Estimate Std. Error z value
## Not at all|Spotting / Very Light   1.5725     0.1712   9.183
## Spotting / Very Light|Light        2.5094     0.1802  13.926
## Light|Moderate                     3.3266     0.1904  17.475
## Moderate|Somewhat Heavy            4.4350     0.2065  21.475
## Somewhat Heavy|Heavy               5.2151     0.2229  23.396
## Heavy|Very Heavy                   6.5315     0.2810  23.241
## (2568 observations deleted due to missingness)</code></pre>
<pre class="r"><code># Flow Color
clmm_flowcolor &lt;- clmm(flow_color ~ phase + (1 | id), data = my_i, Hess = TRUE)</code></pre>
<pre><code>## Warning in update.uC(rho): Non finite negative log-likelihood
##   at iteration 48</code></pre>
<pre class="r"><code>summary(clmm_flowcolor)</code></pre>
<pre><code>## Cumulative Link Mixed Model fitted with the Laplace approximation
## 
## formula: flow_color ~ phase + (1 | id)
## data:    my_i
## 
##  link  threshold nobs logLik   AIC     niter     max.grad cond.H 
##  logit flexible  3041 -1733.01 3486.03 891(3564) 2.66e-03 7.1e+02
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  id     (Intercept) 0.5171   0.7191  
## Number of groups:  id 42 
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## phaseFertility  -1.5180     0.2029  -7.481 7.39e-14 ***
## phaseLuteal     -2.8931     0.2764 -10.467  &lt; 2e-16 ***
## phaseMenstrual   2.1435     0.1280  16.751  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Threshold coefficients:
##                                  Estimate Std. Error z value
## Not at all|Pink                    1.3511     0.1493   9.048
## Pink|Bright Red                    1.4809     0.1506   9.835
## Bright Red|Dark Brown / Dark Red   2.3963     0.1586  15.105
## Dark Brown / Dark Red|Grey         4.3868     0.1903  23.053
## Grey|Black                         4.4633     0.1926  23.178
## Black|Other                        4.5598     0.1957  23.306
## (2618 observations deleted due to missingness)</code></pre>
<pre class="r"><code># Appetite
clmm_app &lt;- clmm(appetite ~ phase + (1 | id), data = my_i, Hess = TRUE)
summary(clmm_app)</code></pre>
<pre><code>## Cumulative Link Mixed Model fitted with the Laplace approximation
## 
## formula: appetite ~ phase + (1 | id)
## data:    my_i
## 
##  link  threshold nobs logLik   AIC     niter     max.grad cond.H 
##  logit flexible  3325 -3615.00 7246.01 603(2993) 1.73e-03 9.3e+01
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  id     (Intercept) 1.398    1.183   
## Number of groups:  id 42 
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## phaseFertility  0.15449    0.09975   1.549    0.121    
## phaseLuteal     0.36579    0.09154   3.996 6.44e-05 ***
## phaseMenstrual  0.11871    0.10475   1.133    0.257    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Threshold coefficients:
##                Estimate Std. Error z value
## Very Low|Low    -3.5037     0.2132 -16.431
## Low|Moderate    -1.0604     0.1971  -5.381
## Moderate|High    1.8759     0.1989   9.430
## High|Very High   4.3591     0.2249  19.384
## (2334 observations deleted due to missingness)</code></pre>
<p>#interpretation: Flow volume and flow color: strong differences
across phases (p &lt; 0.001, Friedman).</p>
<p>Appetite: generally stable, but slightly higher in Luteal phase (CLMM
significant).</p>
<p>Individual differences are substantial, as shown by random effect
variance.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
